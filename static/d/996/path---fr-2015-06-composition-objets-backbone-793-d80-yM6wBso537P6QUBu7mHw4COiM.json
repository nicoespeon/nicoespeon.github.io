{"data":{"site":{"siteMetadata":{"title":"@nicoespeon's blog","subtitles":{"en":"I write about web development, agile practices and personal organization.","fr":"J’écris sur le développement web, les pratiques agiles et l’organisation personnelle."},"author":{"name":"Nicolas Carlo","twitter":"nicoespeon"},"url":"https://www.nicoespeon.com"}},"markdownRemark":{"id":"58a6e0d0-d850-5135-b540-626c98fd9227","html":"<h2 id=\"favor-objects-composition-over-inheritance\"><a href=\"#favor-objects-composition-over-inheritance\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>“Favor objects composition over inheritance”</h2>\n<p>Dans la Programmation Orientée Objet (POO), on crée un certain nombre d’objets avec leur structure de données et les méthodes qui composent leur interface. Pour décider de comment découper nos objets, on suit le <em>Single Responsibility Principle</em> (SRP) : <strong>chaque objet doit avoir une seule et unique raison de changer</strong>.</p>\n<p>Pour faire des choses intéressantes, il faut combiner ces objets.</p>\n<p>Or, en gros, il existe 2 types de relations dans le modèle objets : l’héritage et la composition.</p>\n<p>On peut faire l’analogie avec un arbre généalogique :</p>\n<ul>\n<li><strong>l’héritage</strong>, c’est comme une naissance : quand ça arrive, c’est pour la vie.</li>\n<li><strong>la composition</strong> c’est comme un mariage : ça arrive au cours de l’existence des objets et ça peut changer. Les objets peuvent se séparer et trouver de nouveaux partenaires avec qui s’associer. On notera néanmoins que les objets ne sont pas monogames.</li>\n</ul>\n<blockquote>\n<p>Source: <a href=\"http://www.amazon.com/Object-Design-Roles-Responsibilities-Collaborations/dp/0201379430\">Object Design - Roles, Responsibilities and Collaborations</a></p>\n</blockquote>\n<h3 id=\"heritage-all-the-things\"><a href=\"#heritage-all-the-things\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>“Heritage” all the things!</h3>\n<p>Le premier réflexe des développeurs JavaScript consiste souvent à tenter de reproduire les règles d’héritage pseudo-classique.</p>\n<p>On se retrouve alors vite avec des <code class=\"language-text\">new</code> un peu partout et des chaînes d’héritage longues comme le bras. Ça produit souvent quelque chose <strong>très difficile à maintenir</strong>.</p>\n<p>Il est vrai qu’en Java on dispose de tout ce qu’il faut pour faire de l’héritage avec des classes, des interfaces, etc.</p>\n<p>Ce n’est pas le cas en JavaScript.</p>\n<h3 id=\"keep-it-simple-seriously\"><a href=\"#keep-it-simple-seriously\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Keep It Simple, Seriously</h3>\n<p>En JavaScript, la base, c’est <strong>l’héritage de prototype</strong>.</p>\n<p>Si on oublie le jargon technique, disons qu’on a tout simplement <strong>des objets qui peuvent se lier à d’autres objets</strong> (OLOO).</p>\n<p>Du coup, il est vachement plus simple d’encapsuler les méthodes d’une même logique dans un objet, puis de simplement <strong>retourner cet objet</strong>. Au besoin, on peut aussi créer une fonction qui va retourner un objet (ce qu’on appelle une <em>factory</em>).</p>\n<p>Cet objet on va le prendre, éventuellement le composer avec d’autres, pour former le prototype avec lequel on va instancier notre classe. Tout simplement.</p>\n<p>Pour résumer : plutôt que de créer des chaînes d’héritage plus ou moins bancales à grands coups de constructeurs, créez simplement vos objets et composez les pour former un prototype avec lequel vous allez instancier votre classe.</p>\n<h3 id=\"concatenative-inheritance\"><a href=\"#concatenative-inheritance\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a> Concatenative inheritance</h3>\n<p>Quelqu’un m’a fait très justement remarqué que ce dont je vous parle ici s’appelle <strong>l’héritage multiple</strong>, plutôt que d’<strong>object composition</strong> au sens propre du terme.</p>\n<p>Object composition fait référence au fait de faire pointer les attributs de notre objet vers des instances d’autres classes.</p>\n<p>Il n’y a pas d’héritage multiple à proprement parler en JavaScript. Mais le fait de composer différents prototypes pour en former un nouveau est la notion qui s’en rapproche, ce qui peut générer de la confusion. On parle de “composer des prototypes”, ce qui est le cas, mais pas dans le sens de la composition d’objets…</p>\n<p>Voici pour une explication plus concrète : <a href=\"http://stackoverflow.com/questions/8696695/composition-inheritance-and-aggregation-in-javascript\">Composition, Inheritance, and Aggregation in JavaScript</a></p>\n<p>Du coup, nous appellerons ça la <strong>concatenative inheritance</strong>, <a href=\"https://medium.com/javascript-scene/3-different-kinds-of-prototypal-inheritance-es6-edition-32d777fa16c9#.d084tr4c8\">à la manière d’Eric Eliott</a>.</p>\n<h2 id=\"sur-un-exemple-concret\"><a href=\"#sur-un-exemple-concret\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sur un exemple concret</h2>\n<h3 id=\"contexte\"><a href=\"#contexte\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Contexte</h3>\n<p>Depuis quelques temps déjà, je travaille à temps plein sur <a href=\"https://beta.vinoga.com\">Vinoga</a>, un jeu de social farming sur le vin, développé en HTML5.</p>\n<p>Entre autres bibliothèques, nous utilisons <em>Backbone.js</em> pour découpler simplement nos vues de nos données.</p>\n<p>Prenons donc un cas concret : les éléments sur la carte.</p>\n<p>En posant les choses, on se rend vite compte qu’il y a 2 types d’éléments :</p>\n<ol>\n<li>les <code class=\"language-text\">Props</code> qui sont les éléments de décor (arbres, rochers, chemins…)</li>\n<li>les <code class=\"language-text\">Buildings</code> qui sont les bâtiments du jeu (cuverie, château…)</li>\n</ol>\n<p>Une différence parmi d’autres, mais notable à ce stade : les <code class=\"language-text\">Buildings</code> sont constructibles (depuis le menu de construction), les <code class=\"language-text\">Props</code> ne le sont pas (ils sont déjà sur la carte).</p>\n<p>Quoiqu’il en soit, tous les éléments partagent un comportement commun : ils sont sur la carte. Du coup, <code class=\"language-text\">Props</code> et <code class=\"language-text\">Buildings</code> dérivent tous deux de <code class=\"language-text\">Objects</code>, qui décrit le comportement d’un “objet” sur la carte.</p>\n<p>Mais il y a aussi différents types de <code class=\"language-text\">Buildings</code>, notamment :</p>\n<ul>\n<li>les <code class=\"language-text\">Markets</code> qui sont les bâtiments qui vont refléter l’état de la boutique du joueur</li>\n<li>les <code class=\"language-text\">Productions</code> qui sont les bâtiments qui vont permettre de transformer une ressource (raisin, jus) en produit (jus, bouteille)</li>\n</ul>\n<figure>\n  \n  <a class=\"gatsby-resp-image-link\" href=\"/static/inheritance-c5d1c32d0d373e9764a9d6e00036a163-34743.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n  \n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 454px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 72.90748898678414%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAABlklEQVQoz4WSW6/BUBCF+/v9DW/ePIsnilDSuEQQxK1VpaclHNWq86UT1Qo566HZnb3XzJo1ozxSCMNwu90ej8efGLvd7nK5PL5DSf9cr9fZbFav1weDQb/f5wyfeBRF/5Nvt5tpmpqmwVyv15ZlHQ4H4vf7PXoiQ5YQ1/xAKJfLvu/DcV2XFgqFgij/WPxVGX6pVEKqSAD7/T6fz/d6PQ4oMgzDtu0MmfSEPM9bLBbdbvd0OiV1IOCCGCnSNpsNul5kXszn81arBZMKqE3I/Oq63ul0sLDdbg+Hw+l0iqIXmWSO4yyXy/F4vFqtkJCQsZog0siIC9xCzlSWfmSw2Cv2oJPvZDLJ5XLn87nRaBSLRa54Kfo/jCqBVB6NRnTEgeLNZjPZhd8YHJQoBbJS3IyBt5VKJbGAzmlNrmiHdBzeN4xRy2uRBwG1xMkl40xvVIbMO0qhtlarsWSqqjI/LCSXjINItVrFAoQw/wyZTtATBIEdAy9lC4jLevgxsJOybITy5pMRAxqvGQ9kkc3mcTae4MyM/wDE3kzAR/vqLQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\">\n      <img class=\"gatsby-resp-image-image\" style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\" alt=\"H&#xE9;ritage, niveau 1\" title=\"\" src=\"/static/inheritance-c5d1c32d0d373e9764a9d6e00036a163-34743.png\" srcset=\"/static/inheritance-c5d1c32d0d373e9764a9d6e00036a163-5e482.png 240w,\n/static/inheritance-c5d1c32d0d373e9764a9d6e00036a163-34743.png 454w\" sizes=\"(max-width: 454px) 100vw, 454px\">\n    </span>\n  </span>\n  \n  </a>\n    \n  <figcaption>Notre cha&#xEE;ne d&#x2019;h&#xE9;ritage initiale</figcaption>\n</figure>\n<h3 id=\"À-propos-de-la-constructibilité\"><a href=\"#%C3%80-propos-de-la-constructibilit%C3%A9\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>À propos de la constructibilité</h3>\n<p>Après avoir discuté avec le Game Designer, on se rend finalement compte que les <code class=\"language-text\">Markets</code> ne sont pas constructibles : il sont déjà sur la carte de base.</p>\n<p>La constructibilité est un comportement qui faisait partie intégrante de <code class=\"language-text\">Buildings</code> à ce stade. Mais soit, on peut se dire qu’on va s’en sortir facilement en changeant la chaîne d’héritage ainsi :</p>\n<figure>\n  \n  <a class=\"gatsby-resp-image-link\" href=\"/static/longer-inheritance-chain-5e2522e4c1e65d6347fd1c5e0b7a33bb-44e45.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n  \n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 462px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 107.79220779220779%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAIAAABPIytRAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/klEQVQ4y42Tx67CQAxF5/+/AgmJDSs2rNjRQhdFCFFEDbxHh9BL4CgWUSYIgRfJjGeufX09Vg+PXS6XyWRiWdZyuVytVtPp9Hq9Pj6bkp9t23z3+3273U4kEvV6vVar9Xq97Xbrnn4Ei51Op8FgkMvlms3mn2OwwH+/3+2XaWBxccyGhKlU6na7zefz3W7HNhKJfMksZ9yORqOLxUKKJ1yn0wmHw6PRiOLRgsVms/HGUqZpckCqbrcLW0K4xxyxQLPz+SwR8WhgCqPObDZbrVZJ6wUTNJ/PFwqFZDJZLpe5gEejPRwOZ7MZIdG23+97wa1WCwCCE5Qc3IS5lpkzumo5tl6vpbGiXywWCwaDLEKhUKlUohcivttd5VPSbQl4qKI8ThKi/HvPlHdDbLihLYUgRKVSQd7j8YgnnU5TGuT/HeMCGmsvDFa4YA4AhXlwAEgLhgs4RfnD4cARcbUXBhgJSIjCFMlTEy3RnG2xWMxkMoZhxONxiCCwBkZqGLJAOQaDQOPxmEveFninSPleHLQhCUxYoAJfkkuRKMLA0DlycE09fjCSUCeZQQYCATSnfjx+8PvoiFM6j0hULuH8I/nJoE17oEr/Go0G/FlA/juYnHTLfR7ihPavNZONao2XwVyG5DuYFyqzifIy53zpBXR+ykyFpmMsmDxg9B8VngeF4jVmbixsAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\">\n      <img class=\"gatsby-resp-image-image\" style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\" alt=\"H&#xE9;ritage, niveau 2\" title=\"\" src=\"/static/longer-inheritance-chain-5e2522e4c1e65d6347fd1c5e0b7a33bb-44e45.png\" srcset=\"/static/longer-inheritance-chain-5e2522e4c1e65d6347fd1c5e0b7a33bb-32842.png 240w,\n/static/longer-inheritance-chain-5e2522e4c1e65d6347fd1c5e0b7a33bb-44e45.png 462w\" sizes=\"(max-width: 462px) 100vw, 462px\">\n    </span>\n  </span>\n  \n  </a>\n    \n  <figcaption>Notre cha&#xEE;ne d&#x2019;h&#xE9;ritage modifi&#xE9;e pour s&#x2019;adapter</figcaption>\n</figure>\n<h3 id=\"et-là-cest-le-drame\"><a href=\"#et-l%C3%A0-cest-le-drame\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Et là, c’est le drame</h3>\n<p>Puis le temps passe, les specs évoluent et les features avec : brace yourself, <code class=\"language-text\">Decorations</code> are coming!</p>\n<p>Les <code class=\"language-text\">Decorations</code>, ce sont des éléments de décor (des <code class=\"language-text\">Props</code>), sauf qu’ils sont constructibles eux aussi !</p>\n<p>Bon, à ce stade on est un peu coincés parce-que <code class=\"language-text\">Constructables</code> ça hérite de <code class=\"language-text\">Buildings</code>. On aimerait éviter de dupliquer <code class=\"language-text\">Constructables</code> pour recoder quasiment la même chose côté <code class=\"language-text\">Props</code>.</p>\n<p>Dans le meilleur des scénarios, on se retrouve donc avec des classes qui héritent de propriétés inutiles.</p>\n<figure>\n  \n  <a class=\"gatsby-resp-image-link\" href=\"/static/inheritance-issue-a1fde710e3c6d0b04926b28258acb720-9446b.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n  \n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 500px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 94.60000000000001%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsSAAALEgHS3X78AAACPklEQVQ4y42US5OiQBCE+f9/w4MT4d3zeNYj8hhFRFFA3qDyUOj9gNGZ2XUjpqJD2+7OzsqsaiXxT5zPZ8/zkiSJ4zgIgqqqxH9CegleLBbz+Xy5XG42mzzPWWwf8QI8bDRNw/x0Oum6bts2zGEYrtfr4cCvmGezmeM4ZAsnyNFodOmDjIqieAFmNU3TPMs0TZOXyyeV7/uu66Z9AD4cDvf7/Qs8HMIh5MmqujYMaJ/yyBzlpmkqimL2MUj7AUabH4aupm11fW/b4gG2LAvnIOfq/X5vGMbtdvs77VtdJ+dz+fZ2MYy8r83AgO3T6ZRUJ5MJxUPdd+cehg1Lui442DRZlg11lmW5rmt2VqsVOUMbRRHi+1ON9ES2ed4aBpM0SbCA7ev16vWBTzhHCcuy5C7WuZ31LzC6W9PsmiTPEUmpt9sthPhnbjZKbxuVQzxaVFX9CY6idrfjO0tTNvwgAMxR53CwPS9IU2SkWUbxyZzKoUvqkA+w6MF1VZEhzVUWBUmiL1ksUJ8VBS5gODDS5kzPPJTOccTHx9fPIPichKF4f78ZBs0RR9F4PMZznKMFJXE8ijTtxukkXLf7TBIyaZmQiKoKjLjfK0ZZFmVJC5I5zlEzSchyx+n7dBmwDg+Ax7Badet9neiCnWWBQSrtBLLTFceSUJTuHEPTurS5i4Rpo2/NQEkhpNt2Oy6xjscjXiJbon3F5cIjFrxbJth2vX6W4IGHiuJhMu+UCbS0as/8iwBs9A+GgBY8zPzJ/AFvSzOni26t7gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\">\n      <img class=\"gatsby-resp-image-image\" style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\" alt=\"H&#xE9;ritage, le probl&#xE8;me\" title=\"\" src=\"/static/inheritance-issue-a1fde710e3c6d0b04926b28258acb720-9446b.png\" srcset=\"/static/inheritance-issue-a1fde710e3c6d0b04926b28258acb720-e8980.png 240w,\n/static/inheritance-issue-a1fde710e3c6d0b04926b28258acb720-e7e4f.png 480w,\n/static/inheritance-issue-a1fde710e3c6d0b04926b28258acb720-9446b.png 500w\" sizes=\"(max-width: 500px) 100vw, 500px\">\n    </span>\n  </span>\n  \n  </a>\n    \n  <figcaption>On n&apos;a pas &#xE9;t&#xE9; tr&#xE8;s malins et on est coinc&#xE9;s&#xA0;!</figcaption>\n</figure>\n<h3 id=\"why-so-pseudo-classical\"><a href=\"#why-so-pseudo-classical\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why so pseudo-classical?</h3>\n<p>Alors comment en sommes-nous arrivés là ? Comment s’en sortir ?</p>\n<p>En fait, nous nous sommes un peu précipités quand la problématique de la constructibilité est apparue. Sans plus y réfléchir nous avons tenu la logique ”<code class=\"language-text\">Productions</code> EST un <code class=\"language-text\">Constructables</code> qui EST un <code class=\"language-text\">Buildings</code> qui EST un <code class=\"language-text\">Objects</code>”. Et PAF l’héritage !</p>\n<p>Si on y regarde mieux, la constructibilité c’est un <strong>comportement</strong>. On ne peut pas dire que sans <code class=\"language-text\">Buildings</code> il n’y a pas d’élément <code class=\"language-text\">Constructables</code>. C’est une subtilité et une erreur assez fréquente en JavaScript parce-que l’héritage pseudo-classique c’est la seule chose que l’on retient : c’est le premier (mauvais) réflexe.</p>\n<p>Dans notre cas, la seule chaîne d’héritage vraiment légitime est peut-être celle qui lie <code class=\"language-text\">Decorations</code> à <code class=\"language-text\">Props</code>. Et encore, je dis que l’on peut s’en passer.</p>\n<p>En réalité, ce que l’on fourre dans <code class=\"language-text\">Objects</code>, c’est un ensemble de comportements qui sont communs à <code class=\"language-text\">Props</code> et <code class=\"language-text\">Buildings</code>. Mais en pratique, <code class=\"language-text\">Objects</code> ne représente rien de concret : ce serait une <em>classe abstraite</em> si nous faisions du Java. Idem pour <code class=\"language-text\">Buildings</code> ici d’ailleurs.</p>\n<h3 id=\"embrace-composition\"><a href=\"#embrace-composition\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Embrace composition</h3>\n<p>En JavaScript, je vous suggère de le prendre autrement : décrivons chaque comportement dans un objet qui lui est propre. Laissons tomber les constructeurs et la chaîne d’héritage.</p>\n<p>Puis, combinons ces objets pour former le prototype des objets qui nous intéresse. Pas de <em>classe</em> à l’horizon, simplement des objets qui <strong>se composent</strong> d’autres objets. Éventuellement des <em>factories</em> pour construire le bon objet au besoin.</p>\n<figure>\n  \n  <a class=\"gatsby-resp-image-link\" href=\"/static/composition-resolution-0c2f8090902cbae946591a1c5e15a6c2-9446b.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n  \n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 500px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 60.8%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABjElEQVQoz31Sf4+bMAzl+3+qadL9MU07adV1bdGNI1BCWppykN+ExDNQrp1O25OIjO0XO35OAEEIbLfgHJpq7IlJC/vqop1CEGGF95Dn8PYGux1UFYQAyeSmFNIUrEFzCA7JuTnASo0rHQ0kIL8sQanJMZM5nxxaLym1JSd3vKU/VF/+6hqKIlyvZiWjG3taEWDEGostPBABPsA9iuERn+iMMQn8B4MbK0outtb35j/Qtu0/yEtu3/mcVGdJJLjxMThFGWPJnDfPZSHgGedveap1QtpzZ/66dD6x86ly0/CSlErpeTYRLgA4L4q63Sii7xD4cK9ZFEUUObhWKp1A24mOnWVNa2pRaqUdb9q+OdHQo5jnGMPUlDJGcu4oY8IfL0AryxhP4GV/oj/27c+vT18a1Iwc2+w505vn/VB8B/8Nx3ZrVLNabn6V3B6mnYrXKy6Jsd4p7aWUYgxh1KZ8TbeHDWU8S4/5Ln9v3+/j0NoMo7Sg1ceGParjfUXr7HcmhHCDM9ZYaxdy/CTXHztdtjp3i1n6AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\">\n      <img class=\"gatsby-resp-image-image\" style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\" alt=\"Composition, la solution\" title=\"\" src=\"/static/composition-resolution-0c2f8090902cbae946591a1c5e15a6c2-9446b.png\" srcset=\"/static/composition-resolution-0c2f8090902cbae946591a1c5e15a6c2-e8980.png 240w,\n/static/composition-resolution-0c2f8090902cbae946591a1c5e15a6c2-e7e4f.png 480w,\n/static/composition-resolution-0c2f8090902cbae946591a1c5e15a6c2-9446b.png 500w\" sizes=\"(max-width: 500px) 100vw, 500px\">\n    </span>\n  </span>\n  \n  </a>\n    \n  <figcaption>Il est bien plus simple de jouer aux Legos&#xA0;!</figcaption>\n</figure>\n<p>Dans le cas de où l’on vient augmenter notre prototype avec d’autres objets, qui décrivent des comportements, on parle alors de <strong>mixin</strong>.</p>\n<p>Si notre objet hérite d’un autre objet, on préfèrera utiliser <strong>l’héritage de prototype</strong>.</p>\n<h2 id=\"et-avec-backbone-\"><a href=\"#et-avec-backbone-\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Et avec Backbone ?</h2>\n<h3 id=\"backboneextend\"><a href=\"#backboneextend\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Backbone.extend</h3>\n<p>Quand on utilise Backbone, on se sert de <code class=\"language-text\">.extend()</code> pour surcharger <code class=\"language-text\">Backbone.[Model|Collection|View|…]</code>. Puis on l’instancie avec <code class=\"language-text\">new</code>.</p>\n<p>Du coup, il est assez fréquent de suivre le réflexe de l’héritage pseudo-classique et de se retrouver avec :</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> ObjectsModel <span class=\"token operator\">=</span> Backbone<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span> … <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> BuildingsModel <span class=\"token operator\">=</span> ObjectsModel<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span> … <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> MarketsModel <span class=\"token operator\">=</span> BuildingsModel<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span> … <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ce qui revient d’ailleurs à écrire :</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> MarketsModel <span class=\"token operator\">=</span> Backbone<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>…<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>…<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>…<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Et on instancie au besoin</span>\n<span class=\"token keyword\">var</span> marketsModel <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MarketsModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Backbone est ainsi fait et <code class=\"language-text\">.extend()</code> nous emmène très facilement sur cette pente glissante où les Models dépendent les uns des autres de manière plus ou moins subtile.</p>\n<h3 id=\"composer-son-prototype-puis-étendre\"><a href=\"#composer-son-prototype-puis-%C3%A9tendre\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Composer son prototype PUIS étendre</h3>\n<p>Quitte à devoir hériter de Backbone, autant limiter les dégâts. Ce n’est pas parce-que <code class=\"language-text\">.extend()</code> existe que nous sommes contraints de l’utiliser pour chaque objet que nous créons. Le seul objet que nous ayons à <code class=\"language-text\">.extend()</code> véritablement ici, c’est <code class=\"language-text\">Backbone.Model</code>.</p>\n<p>L’idée, c’est de composer des objets pour former le prototype que nous allons <strong>ensuite</strong> utiliser dans le <code class=\"language-text\">.extend()</code> de notre Model / Collection / Vue…</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> objectsModelProto <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* … */</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> buildingsModelProto <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* … */</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> constructablesModelProto <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* … */</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// On compose pour former un nouveau prototype.</span>\n<span class=\"token keyword\">var</span> marketsModelProto <span class=\"token operator\">=</span> _<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* … */</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// -> interface spécifique à markets</span>\n  objectsModelProto<span class=\"token punctuation\">,</span> <span class=\"token comment\">//</span>\n  buildingsModelProto<span class=\"token punctuation\">,</span> <span class=\"token comment\">// => nos mixins</span>\n  constructablesModelProto<span class=\"token punctuation\">,</span> <span class=\"token comment\">//</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* … */</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token comment\">// -> pour surcharger nos mixins, si besoin</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Une fois le prototype créé, on hérite de Backbone.</span>\n<span class=\"token keyword\">var</span> MarketsModel <span class=\"token operator\">=</span> Backbone<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>marketsModelProto<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Puis on instancie.</span>\n<span class=\"token keyword\">var</span> marketsModel <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MarketsModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Ici <code class=\"language-text\">objectsModelProto</code>, <code class=\"language-text\">buildingsModelProto</code> et <code class=\"language-text\">constructablesModelProto</code> viennent surcharger le prototype de base de <code class=\"language-text\">marketsModelProto</code> pour rajouter des comportements spécifiques.</p>\n<h4 id=\"merge-ou-assign\"><a href=\"#merge-ou-assign\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a> Merge ou assign</h4>\n<p>À noter qu’il peut être intéressant d’utiliser <code class=\"language-text\">_.merge</code> plutôt que <code class=\"language-text\">_.assign</code> si l’on souhaite pouvoir fusionner les attributs. Ça peut être pratique avec Backbone pour fusionner certains attributs tels que <code class=\"language-text\">events</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> objectsViewProto <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  events<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'click .store'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'store'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'click .turn'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'turn'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  store<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token function\">store</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* … */</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  turn<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token function\">turn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* … */</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n_<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span>\n    displayModal<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token function\">displayModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* … */</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    select<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* … */</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  objectsViewProto<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    events<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      click<span class=\"token punctuation\">:</span> <span class=\"token string\">'select'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'click .turn'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'displayModal'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// -></span>\n<span class=\"token comment\">// {</span>\n<span class=\"token comment\">//   events: {</span>\n<span class=\"token comment\">//     \"click\": \"select\",</span>\n<span class=\"token comment\">//     \"click .turn\": \"displayModal\"</span>\n<span class=\"token comment\">//   },</span>\n<span class=\"token comment\">//</span>\n<span class=\"token comment\">//   displayModal: function displayModal () { /* … */ },</span>\n<span class=\"token comment\">//   select: function select () { /* … */ },</span>\n<span class=\"token comment\">//   store: function store () { /* … */ },</span>\n<span class=\"token comment\">//   turn: function turn () { /* … */ }</span>\n<span class=\"token comment\">// }</span>\n\n_<span class=\"token punctuation\">.</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span>\n    displayModal<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token function\">displayModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* … */</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    select<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* … */</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  objectsViewProto<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    events<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      click<span class=\"token punctuation\">:</span> <span class=\"token string\">'select'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'click .turn'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'displayModal'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// -></span>\n<span class=\"token comment\">// {</span>\n<span class=\"token comment\">//   events: {</span>\n<span class=\"token comment\">//     \"click\": \"select\",</span>\n<span class=\"token comment\">//     \"click .store\": \"store\",</span>\n<span class=\"token comment\">//     \"click .turn\": \"displayModal\"</span>\n<span class=\"token comment\">//   },</span>\n<span class=\"token comment\">//</span>\n<span class=\"token comment\">//   displayModal: function displayModal () { /* … */ },</span>\n<span class=\"token comment\">//   select: function select () { /* … */ },</span>\n<span class=\"token comment\">//   store: function store () { /* … */ },</span>\n<span class=\"token comment\">//   turn: function turn () { /* … */ }</span>\n<span class=\"token comment\">// }</span></code></pre></div>\n<h2 id=\"pour-conclure\"><a href=\"#pour-conclure\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pour conclure</h2>\n<p>Préférez la <strong>composition d’objets</strong> plutôt que <strong>l’héritage</strong>. N’utilisez l’héritage que si cela fait vraiment sens, ou si c’est nécessaire. Gare aux longues chaînes d’héritage : c’est fragile.</p>\n<p>Ce qu’il est préférable d’éviter :</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// markets.model.js</span>\n<span class=\"token keyword\">var</span> MarketsModel <span class=\"token operator\">=</span> ConstructablesModel<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* … */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// main.js</span>\n<span class=\"token keyword\">var</span> marketsModel <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MarketsModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Plus flexible, plus simple :</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// markets.model.js</span>\n<span class=\"token keyword\">var</span> marketsModelProto <span class=\"token operator\">=</span> _<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* … */</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// -> interface spécifique à markets</span>\n  objectsModelProto<span class=\"token punctuation\">,</span>\n  buildingsModelProto<span class=\"token punctuation\">,</span>\n  constructablesModelProto\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// main.js</span>\n<span class=\"token keyword\">var</span> MarketsModel <span class=\"token operator\">=</span> Backbone<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>marketsModelProto<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> marketsModel <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MarketsModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Pour finir, voici quelques articles que je vous recommande pour aller plus loin sur le sujet de la composition et de l’héritage en JavaScript :</p>\n<ul>\n<li><a href=\"http://www.datchley.name/understanding-prototypes-delegation-composition/\">Understanding Prototypes, Delegation &#x26; Composition</a> > une explication de A à Z simple, claire et illustrée</li>\n<li><a href=\"https://medium.com/javascript-scene/common-misconceptions-about-inheritance-in-javascript-d5d9bab29b0a\">Common Misconceptions about Inheritance in Javascript</a> > FAQ détaillée qui va au fond de la question</li>\n</ul>","fields":{"tagSlugs":["/fr/tags/javascript/","/fr/tags/backbone-js/","/fr/tags/oop/"],"slug":"/fr/2015/06/composition-objets-backbone/"},"timeToRead":9,"frontmatter":{"title":"Héritage, composition et Backbone.js","tags":["javascript","backbone.js","oop"],"date":"2015-06-19T00:00:00.000Z","description":"Pourquoi la composition d'objets est préférable à l'héritage en JavaScript ? Et surtout, comment applique-t-on cette idée avec Backbone ?"}}},"pageContext":{"slug":"/fr/2015/06/composition-objets-backbone/"}}