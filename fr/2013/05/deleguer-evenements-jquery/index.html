<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1.0"><meta name="description" content="Un petit rappel sur les écouteurs d'événements et les bonnes pratiques de délégations en jQuery."><meta property="og:site_name" content="@nicoespeon's blog" /><meta property="og:url" content="http://www.nicoespeon.com/fr/2013/05/deleguer-evenements-jquery/" /><meta property="og:type" content="article" /><meta property="og:title" content="Déléguer les événements en jQuery | @nicoespeon" /><meta property="og:description" content="Un petit rappel sur les écouteurs d'événements et les bonnes pratiques de délégations en jQuery." /><meta property="og:image" content="https://fr.gravatar.com/userimage/27601663/eb6a327f57a4931bfdf6c213af65ed2d.jpg?size=300" /><title>Déléguer les événements en jQuery | @nicoespeon</title><link rel="icon" href="/assets/img/icon.png"><link rel="author" href="https://plus.google.com/u/0/108378377887967941980"><!-- DNS prefetch for external resources --><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//platform.twitter.com"><link rel="dns-prefetch" href="//p.twitter.com"><link rel="dns-prefetch" href="//cdn.api.twitter.com"><link rel="dns-prefetch" href="//google-analytics.com"><link rel="stylesheet"href='http://fonts.googleapis.com/css?family=Snippet|Roboto:300,100,700'><link rel="stylesheet" href="/assets/css/nicoespeon.css" media="screen"><link rel="stylesheet" href="/assets/css/nicoespeon-print.css" media="print"></head><body><div id="site"><div class="container"><div class="grid"><div class="grid__item seven-tenths portable-one-whole" role="main"><header class="media" role="banner"><!-- Brand logo --><img src="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" class="media__img img--circle" alt="My avatar" width="80" height="80"/><!-- Main navigation --><nav class="media__body" role="navigation"><ul class="nav nav--main"><li><a href="/fr/index.html">Accueil</a></li><li><a href="/fr/about.html">À propos</a></li><li><a href="/fr/projects.html">Projets</a></li><li><a href="/fr/worth-reading.html">À Lire</a></li></ul></nav><!-- /navigation --></header><!-- /header --><article role="main"><h1>Déléguer les événements en jQuery</h1><div class="media"><div class="media__img"><a href="https://twitter.com/share" class="twitter-share-button" data-text="Déléguer les événements en jQuery |" data-via="nicoespeon">Tweeter</a></div><div class="media__body brand-face zeta">(13 Mai, 2013)</div></div><p class="islet">Un petit rappel sur les écouteurs d'événements et les bonnes pratiques de délégations en jQuery.</p><h2 id="tldr">TL;DR</h2><p>Jusqu’à <strong>jQuery 1.7</strong> on faisait la distinction entre <code>$.fn.bind</code>, <code>$.fn.live</code> et <code>$.fn.delegate</code> afin de créer des écouteurs d’événements.</p><p><code>$.fn.bind</code> est la manière la plus basique d’attacher un écouteur à un objet, généralement un noeud du DOM.</p><p><code>$.fn.live</code> est plus puissant car il attache l’écouteur à la racine du document et fait <em>vivre</em> le comportement sur chaque élément du DOM correspondant, y compris ceux créés par la suite.</p><p><code>$.fn.delegate</code> se comporte plus ou moins comme <code>$.fn.live</code> à ceci près que l’on spécifie un noeud du DOM où l’on attache notre écouteur <em>live</em>, ce qui est bien plus rapide à l’exécution.</p><p><code>$.fn.delegate</code> est plus performant que <code>$.fn.live</code> qui est plus performant que <code>$.fn.bind</code>.</p><p>Depuis <strong>jQuery 1.7</strong>, toutes ces méthodes ont étés remplacées par l’unique méthode <code>$.fn.on</code>. Les principes de performance sont les mêmes, seule la syntaxe change.</p><h2 id="never-gonna-bind-you-up">Never gonna <code>bind</code> you up</h2><p>C’est la méthode la plus élémentaire pour attacher un écouteur d’événements à un objet jQuery. Elle est généralement utilisée sur des éléments du DOM dans le but de créer des intéractions avec l’utilisateur :</p><div class="highlight"><pre><code class="javascript"><span class="c1">// Utilisation basique de $.fn.bind</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;div#main-content&#39;</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
</code></pre></div><p>Notre objet écoute désormais l’événement nommé <code>'click'</code> et réagira à chaque fois que cet événement sera déclenché. Sur l’exemple précédent par exemple, la fonction définie sera déclenchée à chaque fois que l’on cliquera sur l’élément <code>#main-content</code>.</p><p><code>'click'</code> est l’un des noms d’événements usuels qui dispose d’une méthode raccourcie équivalente :</p><div class="highlight"><pre><code class="javascript"><span class="c1">// Équivalent du code précédent</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;div#main-content&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
</code></pre></div><p>Cependant, il est possible de spécifier n’importe quel nom d’événement utilisé dans le code. En fait, c’est le point de départ de la <a href="http://fr.wikipedia.org/wiki/Programmation_%C3%A9v%C3%A9nementielle">programmation événementielle</a> en JS, permettant de créer des applications web avancées.</p><div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#foo&#39;</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;my-event&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#foo&#39;</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;my-event&#39;</span><span class="p">);</span>  <span class="c1">// Déclenchera l&#39;événement lié</span>
</code></pre></div><p class="islet">La méthode pour arrêter un tel écouteur est <code>$.fn.unbind</code>.</p><p>Avant <strong>jQuery 1.7</strong>, c’était la manière la plus basique de faire les choses.</p><h2 id="born-to-be-a-live">Born to be a <code>live</code></h2><p>Bien que le principe de <code>$.fn.bind</code> soit sympatoche, la méthode est assez limitée. Typiquement, elle a deux inconvénients :</p><ol><li><p>Il attache un écouteur pour chacun des éléments qui correspondent au sélecteur, ce qui n’est pas la solution la plus optimale lorsque l’on cible plus d’un élément</p></li><li><p>Il attache un écouteur seuelement sur les éléments qui correspondent au sélecteur à ce moment précis, si vous modifiez le DOM et souhaitez créer de nouveaux éléments identiques, il vous faudra attacher les événements à nouveau.</p></li></ol><div class="highlight"><pre><code class="javascript"><span class="c1">// Pas glop...</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;a.tooltip&#39;</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
<span class="c1">// ou $(&#39;a.tooltip&#39;).click(function() { ... });</span>
</code></pre></div><p>La solution développée avant <strong>jQuery 1.7</strong> était la méthode <code>$.fn.live</code> :</p><div class="highlight"><pre><code class="javascript"><span class="c1">// Utilisation basique de $.fn.live</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li.text-info&#39;</span><span class="p">).</span><span class="nx">live</span><span class="p">(</span><span class="s1">&#39;hover&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
</code></pre></div><p>Au lieu d’attacher un écouteur d’événements à chaque élément, il en attache un au niveau du <em>document root</em>. Ainsi, chaque nouvel élément qui correspond au sélecteur se comportera de la même manière. De plus, c’est <strong>bien plus efficace</strong> en termes de performance.</p><p class="islet">La méthode pour arrêter un tel écouteur est <code>$.fn.die</code>.</p><p>Cette méthode est dépréciée depuis <strong>jQuery 1.7</strong>, mais le principe reste le même, ce qui est bon à savoir.</p><h2 id="learn-to-delegate">Learn to <code>delegate</code></h2><p>La méthode <code>$.fn.delegate</code> est basiquement la même que <code>$.fn.live</code>, présentant les mêmes avantages par rapport à <code>$.fn.bind</code>:</p><div class="highlight"><pre><code class="javascript"><span class="c1">// Utilisation basique de $.fn.delegate</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;ul#main-navigation&#39;</span><span class="p">).</span><span class="nx">delegate</span><span class="p">(</span><span class="s1">&#39;li.text-info&#39;</span><span class="p">,</span> <span class="s1">&#39;hover&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
</code></pre></div><p>Le truc c’est que, au lieu d’attacher chaque écouteur au <em>document root</em>, vous spécifiez l’élément du DOM où vous souhaitez porter votre attention. Ainsi, vous <strong>augmentez significativement la performance</strong> car c’est bien plus spécifique !</p><p class="islet">La méthode pour arrêter un tel écouteur est <code>$.fn.undelegate</code>.</p><h2 id="turn-me-on">Turn me <code>on</code></h2><p>Depuis <strong>jQuery 1.7</strong>, toutes les précédentes méthodes ont étés fusionnées dans une seule, puissante et unique méthode : <code>$.fn.on</code>.</p><p>Maintenant que vous avez compris comment les précédentes fonctionnent, voyons quels sont leur équivalent avec la syntaxe de celle-ci :</p><div class="highlight"><pre><code class="javascript"><span class="c1">// Utilisation basique de $.fn.on au lieu de $.fn.bind</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;div#main-content&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>

<span class="c1">// Utilisation basique de $.fn.on au lieu de $.fn.live</span>
<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;hover&#39;</span><span class="p">,</span> <span class="s1">&#39;li.text-info&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>

<span class="c1">// Utilisation basique de $.fn.on au lieu de $.fn.delegate</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;ul#main-nav&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;hover&#39;</span><span class="p">,</span> <span class="s1">&#39;li.text-info&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
</code></pre></div><p>La distinction entre <code>$.fn.live</code> et <code>$.fn.delegate</code> et plus claire avec cette simple méthode, l’accent mis sur la délégation prend son sens (sauf si vous souhaitez explicitement attacher votre écouteur à la racine du document, ce qui est rare).</p><p>Vous pouvez également passer des <strong>event data</strong> via la méthode :</p><div class="highlight"><pre><code class="javascript"><span class="c1">// Attache des données à l&#39;événement</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">index</span><span class="o">:</span><span class="nx">i</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;My index is &#39;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">index</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre></div><p>L’utilisation de <code>$.fn.on</code> est instinctive et rend la gestion événementielle très facile à prendre en main avec jQuery!</p><p class="islet">La méthode pour arrêter un tel écouteur est... <code>$.fn.off</code>.</p><h2 id="et-pour-la-performance-">Et pour la performance ?</h2><p>Comme expliqué, voici le listing des méthodes, de la plus performante à la moins performante :</p><ol><li><code>.on(events, selector, [data,] handler)</code> équivaut à <code>$.fn.delegate</code></li><li><code>$(document).on(events, selector, [data,] handler)</code> équivaut à <code>$.fn.live</code></li><li><code>.on(events, [data,] handler)</code> équivaut à <code>$.fn.bind</code></li></ol><p>Pour résumer :</p><ul><li>Si vous avez besoin d’attacher un écouteur d’événements à plus d’un élément, utilisez <code>.on(events, selector, [data,] handler)</code></li><li>Si vous n’avez pas d’ancre sur laquelle vous rattacher, utilisez <code>$(document).on(events, selector, [data,] handler)</code></li><li>Sinon, utilisez <code>.on(events, [data,] handler)</code>, ou la fonction raccourcie s’il y en a une</li></ul><h2 id="conclusion">Conclusion</h2><p>C’était un bref et gentil rappel sur la délégation des événements en jQuery.</p><p>Rien de nouveau sous le soleil mais cette article traite d’un point important. C’est un point à savoir que vous pouvez facilement retrouver sur le net en faisant quelques recherches.</p><p>Je me suis rendu compte il y a quelque temps que j’avais la fâcheuse tendance de toujours utiliser la fonction raccourcie, même pour traiter un certain nombre d’éléments, alors que j’aurais pu employer des méthodes bien plus efficaces. <strong>Lorsque vous vous retrouvez à gérer plus d’un élément, pensez à la méthode <code>$.fn.on</code> !</strong></p><p>J’espère que ce petit point vous aura appris quelque chose ou rafraîchi la mémoire. Si c’est le cas, n’hésitez pas à me laisser votre opinion ci-dessous ;-)</p><p>Plop!</p><div id="disqus_thread" role="complementary"></div></article></div><div class="grid__item three-tenths portable-one-whole"role="complementary"><!-- Lang navigation --><nav role="navigation"><ul class="nav nav--stacked text--center"><li ><a href="/">English version</a></li><li class="current" ><a href="/fr/">Version française</a></li></ul></nav><!-- About --><aside class="text--justify"><p>Je m'appelle <span class='brand-face'>Nicolas</span> et je suis Consultant chez <a href='http://www.octo.com/'>OCTO Technology</a>.</p><p>Je <a href='/archive'>rédige</a> des articles sur le développement web et la gestion de projets. Je suis <a href='http://www.linkedin.com/profile/view?id=143126897'>LinkedIn</a>, je <a href='https://github.com/nicoespeon/'>code</a> et je <a href='http://twitter.com/nicoespeon'>tweet</a> pas mal aussi.</p><p>J’ai tendance à <a href='https://medium.com/@nicoespeon'>écrire sur Medium</a> désormais, si vous souhaitez suivre mes articles ;-)</p></aside><!-- RSS --><aside><p class="text--center"><a href="http://www.nicoespeon.com/feed.xml"><i class="icon-connection"></i>&nbsp;Restez connectés</a></p></aside><!-- Tweets --><aside class="text--center visuallyhidden--portable"><a class="twitter-timeline" href="https://twitter.com/nicoespeon" data-widget-id="320422386929377280">Tweets de @nicoespeon</a></aside><aside class="visuallyhidden--portable push--top"><h2 class="text--center">Copains</h2><a href="http://iceranking.com">IceRanking.com</a> - (SEO) Cédric Brun, Consultant en Référencement Durable</aside></div></div></div><!-- /container --></div><!-- /main-content --><footer role="contentinfo"><div class="container"><p>&copy; 2016 - <a href="https://twitter.com/nicoespeon">Nicolas (Espeon) Carlo</a><br>Ce site est construit grâce à <a href='https://github.com/mojombo/jekyll'>Jekyll</a> et à <a href='http://inuitcss.com/'>inuit.css</a> de l'excellent <a href='https://twitter.com/csswizardry'>@csswizardry</a>. Le code source est <a href='https://github.com/nicoespeon/nicoespeon.github.io'>hébergé sur GitHub</a>.</p></div></footer><!-- jQuery --><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script>$( function () {/*** This JS code is still small so its better to keep it inline.** Only apply if we are beyond the desk CSS breakpoint on load*/if ( $( window ).width() >= 1024 ) {var $timeline = $( "ul#timeline" );/*** Then hide every label description of the timeline*/$timeline.find( "a.timeline__label" ).each( function () {$( this ).find( "p" ).hide();} );/*** And delegate the visibility effect on hover for each label description*/$timeline.on( "mouseenter mouseleave", "a.timeline__label", function () {$( this ).find( "p" ).stop().toggle( "slow" );} );}/*** Append anchor to page subtitles with IDs (used for blog posts).*/$( "h2[id], h3[id]" ).each( function () {var $title = $( this );var $anchor = $( "<a href='#" + $title.attr( "id" ) + "' class='anchor'><i class='icon-link'></i></a>" );$title.append( $anchor );} );} );</script><!-- Twitter API --><script>!function ( d, s, id ) {var js, fjs = d.getElementsByTagName( s )[0];if ( !d.getElementById( id ) ) {js = d.createElement( s );js.id = id;js.src = "//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore( js, fjs );}}( document, "script", "twitter-wjs" );</script><!-- Google Analytics --><script>var _gaq = _gaq || [];_gaq.push( ['_setAccount', 'UA-39957541-2'] );_gaq.push( ['_setDomainName', 'nicoespeon.com'] );_gaq.push( ['_trackPageview'] );(function () {var ga = document.createElement( 'script' );ga.type = 'text/javascript';ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName( 'script' )[0];s.parentNode.insertBefore( ga, s );})();</script><!-- Disqus --><script>var disqus_shortname = 'nicoespeon';var disqus_url = 'http://nicoespeon.com/fr/2013/05/deleguer-evenements-jquery/';var title = "Déléguer les événements en jQuery";(function () {var dsq = document.createElement( 'script' );dsq.type = 'text/javascript';dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName( 'head' )[0] || document.getElementsByTagName( 'body' )[0]).appendChild( dsq );})();</script><noscript>Please enable JavaScript to view the <ahref="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></body></html>