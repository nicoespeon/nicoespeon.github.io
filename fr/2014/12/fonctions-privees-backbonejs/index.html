<!DOCTYPE html><html lang="fr" xmlns:og="http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1.0"><meta name="description" content="Pourquoi et comment faire des fonctions privées. Et concrètement, comment implémenter ça tout en utilisant Backbone.js."><meta property="og:site_name" content="@nicoespeon's blog" /><meta property="og:url" content="http://nicoespeon.com/fr/2014/12/fonctions-privees-backbonejs/" /><meta property="og:type" content="article" /><meta property="og:title" content="Fonctions privées avec Backbone.js | @nicoespeon" /><meta property="og:description" content="Pourquoi et comment faire des fonctions privées. Et concrètement, comment implémenter ça tout en utilisant Backbone.js." /><meta property="og:image" content="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" /><title>Fonctions privées avec Backbone.js | @nicoespeon</title><link rel="icon" href="/assets/img/icon.png"><link rel="author" href="https://plus.google.com/u/0/108378377887967941980"><!-- DNS prefetch for external resources --><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//platform.twitter.com"><link rel="dns-prefetch" href="//p.twitter.com"><link rel="dns-prefetch" href="//cdn.api.twitter.com"><link rel="dns-prefetch" href="//google-analytics.com"><link rel="stylesheet"href='http://fonts.googleapis.com/css?family=Snippet|Roboto:300,100,700'><link rel="stylesheet" href="/assets/css/nicoespeon.css" media="screen"><link rel="stylesheet" href="/assets/css/nicoespeon-print.css" media="print"></head><body><div id="site"><div class="container"><div class="grid"><div class="grid__item seven-tenths portable-one-whole" role="main"><header class="media" role="banner"><!-- Brand logo --><img src="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" class="media__img img--circle" alt="My avatar" width="80" height="80"/><!-- Main navigation --><nav class="media__body" role="navigation"><ul class="nav nav--main"><li><a href="/fr/index.html">Accueil</a></li><li><a href="/fr/about.html">À propos</a></li><li><a href="/fr/projects.html">Projets</a></li><li><a href="/fr/worth-reading.html">A Lire</a></li></ul></nav><!-- /navigation --></header><!-- /header --><article role="main"><h1>Fonctions privées avec Backbone.js</h1><div class="media"><a href="https://twitter.com/share" class="twitter-share-button media__img--rev" data-text="Fonctions privées avec Backbone.js |" data-via="nicoespeon">Tweeter</a><div class="media__body brand-face zeta">(07 Décembre, 2014)</div></div><p class="islet">Pourquoi et comment faire des fonctions privées. Et concrètement, comment implémenter ça tout en utilisant Backbone.js.</p><h2 id="toc_0">Fonctions privées, c&#39;est-à-dire ?</h2><p>Pour faire simple et concis : une fonction / méthode privée est une méthode qui n&#39;est pas exposée et ne peut donc pas être appelée &quot;de l&#39;extérieur&quot;.</p><p>Il s&#39;agit donc d&#39;une notion de <strong>portée</strong>, ni plus ni moins.</p><div class="highlight"><pre><code class="javascript"><span class="kd">function</span> <span class="nx">yolo</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">privateMethod</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;can&#39;t be accessed outside of `yolo()`&quot;</span> <span class="p">);</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">privateVar</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

  <span class="c1">// ici, on peut appeler `privateMethod` si ça nous chante.</span>
  <span class="c1">// ici, `privateVar` vaut `true`.</span>

  <span class="k">return</span> <span class="s2">&quot;that&#39;s all you&#39;ve got from me!&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// ici, `privateMethod` n&#39;existe pas.</span>
<span class="c1">// ici, `privateVar` n&#39;est pas défini.</span>

<span class="nx">yolo</span><span class="p">();</span> <span class="c1">// affiche &quot;that&#39;s all you&#39;ve got from me!&quot;</span>
</code></pre></div><p>Cette notion prend tout son sens lorsqu&#39;on utilise le <em>module pattern</em>.</p><p>Pour en savoir plus sur ce point, je vous recommande cet article parmi tous les autres : <a href="http://toddmotto.com/mastering-the-module-pattern">Mastering the module pattern</a>, simple et efficace.</p><p>Et donc concrètement, ça donne ce genre de code :</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">MyModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// tout un tas de trucs encapsulés -&gt; privés si pas exposés.</span>
  <span class="kd">var</span> <span class="nx">_cantTouchThis</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;I just met you!&quot;</span> <span class="p">);</span>
  <span class="p">};</span>

  <span class="kd">var</span> <span class="nx">_nbOfCats</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

  <span class="c1">// ce que l&#39;on retourne lorsque la fonction est exécutée</span>
  <span class="c1">// -&gt; ce qu&#39;on expose (= public).</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">nbOfRainbows</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">sayHi</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Hi!&quot;</span> <span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">logNumberOfRainbows</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">nbOfRainbows</span> <span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">logNumberOfCats</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">_nbOfCats</span> <span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">touchThis</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Hey!&quot;</span> <span class="p">);</span>
      <span class="nx">_cantTouchThis</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">})();</span>
</code></pre></div><p>Ceci nous permet donc de toucher à la partie publique, <strong>l&#39;interface</strong>, sans pour autant avoir accès à la partie privée :</p><div class="highlight"><pre><code class="javascript"><span class="nx">MyModule</span><span class="p">.</span><span class="nx">nbOfRainbows</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
<span class="nx">MyModule</span><span class="p">.</span><span class="nx">logNumberOfRainbows</span><span class="p">();</span> <span class="c1">// affiche &quot;42&quot;</span>
<span class="nx">MyModule</span><span class="p">.</span><span class="nx">logNumberOfCats</span><span class="p">();</span> <span class="c1">// affiche &quot;3&quot;</span>
<span class="nx">MyModule</span><span class="p">.</span><span class="nx">touchThis</span><span class="p">();</span> <span class="c1">// affiche &quot;Hey!&quot; &quot;I just met you!&quot;</span>
</code></pre></div><h2 id="toc_1">Fonctions privées… Et pour quoi faire ?</h2><p>Question légitime. Personnellement, je vois l&#39;intérêt d&#39;une fonction privée ainsi :</p><ul><li>elle <strong>simplifie l&#39;interface publique</strong> en s&#39;occupant des détails techniques d&#39;implémentation</li><li>elle <strong>n&#39;a pas à être testée unitairement</strong></li></ul><p>Le premier point coule généralement de source. Le second point découle du premier, mais rend souvent perplexe. Je m&#39;explique…</p><h2 id="toc_2">Tests unitaires et fonctions privées</h2><p>Pour tester notre module, on l&#39;instancie, puis on va prendre chacune de ses méthodes et vérifier leur sortie à partir d&#39;une entrée (variables + contexte). On teste <em>unitairement</em> les méthodes exposées en prenant garde de faire varier l&#39;entrée pour tester tous les cas de figure et obtenir une bonne couverture de tests.</p><p>On peut d&#39;ailleurs résumer la pratique du <strong>Test Driven Development</strong> (TDD) :</p><ul><li>écrire d&#39;abord le test avec les cas de figures requis pour une fonctionnalité</li><li>coder la méthode afin de passer ces tests</li><li>retravailler le code à la fin pour le nettoyer. Tant que les tests passent on sait qu&#39;on n&#39;a rien cassé.</li></ul><p>L&#39;étape de <em>refactor</em> vient en dernier car l&#39;objectif est de produire un code qui fonctionne, puis de faire des optimisations.</p><p>Pour revenir à la question des méthodes privées : elles ne sont pas exposées, donc <em>techniquement</em> elles ne sont pas testées unitairement. Pas directement en fait.</p><h2 id="toc_3">Quelques considérations sur les fonctions privées</h2><p>Le point sur les tests unitaires peut laisser perplexe selon la manière dont on considère et utilise la notion de fonction privée. Je dirais qu&#39;il y a 2 façons de voir les choses :</p><ol><li>je code tout en privé et j&#39;expose que ce qui doit l&#39;être <em>in fine</em></li><li>les fonctions privées sont le fruit du refactor de mes fonctions publiques</li></ol><h3 id="toc_4">Comment choisir entre privé et public ?</h3><p>Si on considère que l&#39;on fait du TDD… on développe l&#39;interface publique <strong>avant</strong> (puisque c&#39;est ce que testent les tests).</p><p>Personnellement, je code mes tests (qui ne passent pas), puis mon interface publique : les méthodes publiques ou les <em>event handlers</em> (petit point là-dessus plus bas, pour ceux qui s&#39;interrogent). Rien de privé chez moi à ce stade.</p><p>Les fonctions privées proviennent de l&#39;étape de refactor, finalement. Et puis si je n&#39;ai pas le temps de nettoyer, au moins ça marche.</p><p>Finalement, <strong>les tests unitaires testent l&#39;interface publique</strong>.</p><p>Les méthodes privées sont testées à travers les méthodes publiques. On peut se dire que tester le détail de l&#39;implémentation technique serait judicieux pour mieux debugguer, mais c&#39;est un coût d&#39;implémentation et de maintenance conséquent. À l&#39;inverse, je peux ici modifier / refactor mes méthodes privées autant que je veux tant que mon module fonctionne.</p><p>À choisir : autant tester plus de scénarios sur l&#39;interface publique. La coverage indiquera si oui ou non on teste les méthodes privées en passant.</p><h3 id="toc_5">Le cas des events handlers</h3><p>L&#39;interface publique, c&#39;est donc ce qui compte.</p><p>Qu&#39;en est-il des événements qui font réagir notre module ? Les events handlers (= <code>onClick()</code> &amp; co) doivent-elles être publiques pour pouvoir être testées ?</p><p>En fait, non.</p><p>On parle d&#39;événements. Notre module écoute des événements et réagit en fonction. Les tests doivent donc déclencher le comportement en émettant les événements, puis en observant le résultat attendu (impact sur le système, etc.). La méthode liée peut bien être publique ou privée, ce n&#39;est pas ce qui compte au moment où l&#39;on teste la manière dont le module répond à l&#39;événement.</p><h3 id="toc_6">Préfixer avec &quot;_&quot;</h3><p>Par convention (assez répandue), on préfixe les noms des méthodes / variables privées avec un <code>_</code>.</p><p>C&#39;est également ce que je fais pour 2 raisons :</p><ol><li>c&#39;est une convention qui présente l&#39;avantage de se démarquer. On n&#39;a pas de <code>private</code> en JS, mais la plupart comprendront qu&#39;on parle là d&#39;une fonction &quot;supposée&quot; privée…</li><li>cela facilite le travail de documentation automatique. Souvent, par convention, l&#39;autocompletion considérera cette fonction comme privée et n&#39;oubliera pas de mettre <code>@private</code>. Ça vaut ce que ça vaut, en tout cas ça ne coûte rien \o/</li></ol><p>C&#39;est donc personnellement une considération de <strong>clarté</strong>. La nature <em>privée</em> de la méthode <code>_joke()</code> saute plus facilement aux yeux.</p><p>En revanche, il est assez commun que cette convention soit utilisée pour tenter de <strong>définir</strong> la nature privée d&#39;une méthode au lieu de la mettre en valeur. C&#39;est-à-dire que l&#39;interface publique exposée est composée de méthodes dont certaines sont préfixées avec <code>_</code> pour indiquer que celles-ci doivent être <em>considérées comme privées</em>.</p><p class="islet">C'est un point qui génère de nombreux débats. D'après mon expérience personnelle, c'est généralement quelque chose qui est mis en place quand on ne sait pas trop comment on fait pour véritablement mettre en place des méthodes privées. Du coup tout est public, mais on indique que certaines sont <em>privées par intention</em>.</p><p>En pratique, il est assez simple de mettre en place des méthodes privées avec le <em>module pattern</em>. Tant qu&#39;à faire, je conseille donc de partir du principe que tout ce qui est exposé est public. Si on souhaite qu&#39;une fonction soit privée, alors autant l&#39;écrire comme telle et utiliser le préfixe <code>_</code> simplement pour la lisibilité du code.</p><p>Cela étant, à chaque projet de définir et suivre ses conventions selon ses besoins.</p><h3 id="toc_7">C&#39;est pas dans le prototype… du coup pour l&#39;héritage et la performance ?</h3><p>Effectivement, étant donné qu&#39;elle n&#39;est pas accessible, <strong>une méthode privée ne peut pas être surchargée</strong>. C&#39;est la raison pour laquelle je considère les méthodes privées comme un moyen de simplifier l&#39;interface exposée de mon module. Si j&#39;ai besoin du détail de l&#39;implémentation, que je dois pouvoir y accéder en héritant ma classe, alors j&#39;ai besoin que ce détail soit public.</p><p>Là encore, le scepticisme n&#39;est pas tellement causé la nature des méthodes privées en soi, mais plutôt à une interprétation / implémentation maladroite de celles-ci.</p><p>On notera également le point sur la performance : il y aura autant de fonctions privées que d&#39;instances de mon module, ce qui est techniquement <em>moins performant</em>. Mais en <a href="http://jsperf.com/public-vs-private-methods">analysant effectivement l&#39;impact</a>, cette remarque relève de l&#39;ordre de l&#39;optimisation précoce dans mon utilisation des méthodes privées, pour le moment.</p><h3 id="toc_8">Et comment j&#39;accède à mes méthodes publiques depuis mes méthodes privées ?</h3><p>Ceci peut être un point de blocage.</p><p>En fait, si ma fonction privée provient d&#39;un refactor de ma méthode publique, ce n&#39;en est plus un. Tout simplement parce-que ma méthode privée a pour rôle de simplifier l&#39;interface publique, c&#39;est-à-dire de <strong>rendre plus lisible</strong> ma méthode publique.</p><p>J&#39;envisage donc la méthode privée comme un &quot;helper&quot; personnel du module, dont il se sert pour faire son travail. Toutes les variables dont la méthode a besoin lui son donc passées en paramètre.</p><p>Ainsi, on peut simplement envisager de passer le contexte de l&#39;interface publique à la méthode privée :</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">MyModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">_addSomeCats</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">cats</span><span class="o">++</span><span class="p">;</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">logNumberOfCats</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">cats</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">addSomeCats</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// En soi cela n&#39;a pas grand intérêt ici de tout envoyer</span>
      <span class="c1">// dans une méthode privée, mais c&#39;est pour illustrer la</span>
      <span class="c1">// manière dont on passe le contexte.</span>
      <span class="nx">_addSomeCats</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">logNumberOfCats</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">cats</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">})();</span>
</code></pre></div><p>Ce qui donnera :</p><div class="highlight"><pre><code class="javascript"><span class="nx">MyModule</span><span class="p">.</span><span class="nx">addSomeCats</span><span class="p">();</span> <span class="c1">// affiche &quot;2&quot;</span>
</code></pre></div><p class="islet">Dans cet exemple, le contexte est passé en paramètre.<br>En pratique, il est possible d'utiliser <code>this</code> dans la méthode <code>_addSomeCats</code> et de l'appeller en lui passant le contexte avec <code>.call()</code> ainsi : <code>_addSomeCats.call( this );</code>.</p><p>L&#39;exemple précédent ne présente pas un grand intérêt, mais concrètement cela peut se présenter de la manière suivante dans un projet :</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">MyModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// syntaxe alternative de `var _createViewInstance = function() { … }`.</span>
  <span class="c1">// on a refactor ici quelques tâches répétitives du module.</span>
  <span class="kd">function</span> <span class="nx">_createViewInstance</span> <span class="p">(</span> <span class="nx">View</span><span class="p">,</span> <span class="nx">$parent</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">View</span> <span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span> <span class="s2">&quot;No View constructor provided&quot;</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">$parent</span> <span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span> <span class="s2">&quot;No $parent provided&quot;</span> <span class="p">);</span>

    <span class="kd">var</span> <span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">View</span><span class="p">();</span>
    <span class="nx">view</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span> <span class="nx">$parent</span> <span class="p">);</span>
    <span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>

    <span class="k">return</span> <span class="nx">view</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// …</span>

  <span class="k">return</span> <span class="p">{</span>

    <span class="nx">onRender</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ordersView</span> <span class="o">=</span> <span class="nx">_createViewInstance</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">OrdersView</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span> <span class="s2">&quot;#orders&quot;</span> <span class="p">)</span> <span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">err</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">app</span><span class="p">.</span><span class="nx">err</span><span class="p">(</span> <span class="nx">err</span> <span class="p">);</span> <span class="c1">// -&gt; notre façon de log les erreurs qui peuvent subvenir</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ordersView</span> <span class="o">=</span> <span class="p">{};</span>
      <span class="p">}</span>

      <span class="c1">// un tas d&#39;autres trucs…</span>
    <span class="p">}</span>

    <span class="c1">// …</span>
  <span class="p">};</span>
<span class="p">})();</span>
</code></pre></div><p>Ce qui nous amène effectivement à <strong>Backbone.js</strong>.</p><h2 id="toc_9">Implémentation avec Backbone.js</h2><p>C&#39;est le point qui fut pour moi la cause de cet article. En effet, après avoir assimilé le concept et bien visualisé sa mise en place avec un module, on peut rester perplexe sur la manière de l&#39;implémenter quand on à l&#39;habitude de ceci :</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">MyModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">Books</span> <span class="o">=</span> <span class="p">{};</span>

  <span class="nx">Books</span><span class="p">.</span><span class="nx">Model</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="c1">// un peu de configuration…</span>

    <span class="nx">isPrivate</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;certainly not…&quot;</span> <span class="p">);</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">_intendedToBePrivate</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// le genre de méthode qui apparaît dans ce genre de situation.</span>
    <span class="p">}</span>

  <span class="p">});</span>

  <span class="c1">// …</span>

  <span class="k">return</span> <span class="nx">Books</span><span class="p">;</span>

<span class="p">})();</span>
</code></pre></div><p>Finalement, le principe est simple : <code>.extend()</code> prend un objet en paramètre. Qu&#39;à cela ne tienne, on peut lui envoyer une <a href="http://nicoespeon.com/fr/2013/05/bien-isoler-ses-variables-en-javascript/">IIFE</a> qui lui retourne un objet (son API).</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">MyModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">Books</span> <span class="o">=</span> <span class="p">{};</span>

  <span class="kd">var</span> <span class="nx">ModelConfiguration</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_actuallyPrivate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;look &#39;ma, I&#39;m private!&quot;</span> <span class="p">);</span>
    <span class="p">};</span>

    <span class="c1">// on expose la configuration.</span>
    <span class="k">return</span> <span class="p">{</span>

      <span class="nx">defaults</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">isCompleted</span><span class="o">:</span> <span class="kc">false</span>
      <span class="p">},</span>

      <span class="nx">urlRoot</span><span class="o">:</span> <span class="s2">&quot;/order&quot;</span><span class="p">,</span>

      <span class="nx">isCompleted</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">_actuallyPrivate</span><span class="p">();</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;isCompleted&quot;</span> <span class="p">);</span>
      <span class="p">}</span>

    <span class="p">};</span>
  <span class="p">})();</span>

  <span class="nx">Books</span><span class="p">.</span><span class="nx">Model</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="nx">ModelConfiguration</span> <span class="p">);</span>

  <span class="c1">// …</span>

  <span class="k">return</span> <span class="nx">Books</span><span class="p">;</span>

<span class="p">})();</span>
</code></pre></div><h2 id="toc_10">Pour conclure</h2><p>La question des fonctions privées et de leur intérêt fait toujours débat et peut laisser sceptique. Parfois (souvent ?), ça complique plus le schmilblick qu&#39;autre chose. Aussi, chaque projet doit trouver midi à sa porte et adopter la position qui lui convient.</p><p>En ce qui me concerne, <strong>je crée des méthodes privées lors de mes opérations de refactor</strong>. Si la méthode est publique par nature, je la traite comme telle : pas de préfixe <code>_</code>, des tests unitaires. Le plus important pour moi, c&#39;est de ne pas me leurrer avec une convention.</p><p>Quoiqu&#39;il en soit, je me suis questionné un bon moment pour comprendre comment cela pouvait se traduire en utilisant <em>Backbone.js</em>. Et comme j&#39;ai eu du mal à faire le déclic, je me suis fendu de cet article pour aider les prochains qui entreront dans les mêmes réflexions que j&#39;ai pu avoir.</p><p>Cela étant, c&#39;est un point à débats et à réflexions. N&#39;hésitez donc pas, je suis preneur de suggestions et remarques à ce sujet !</p><div id="disqus_thread" role="complementary"></div></article></div><div class="grid__item three-tenths portable-one-whole"role="complementary"><!-- Lang navigation --><nav role="navigation"><ul class="nav nav--stacked text--center"><li ><a href="/">English version</a></li><li class="current" ><a href="/fr/">Version française</a></li></ul></nav><!-- About --><aside class="text--justify"><p>Je m'appelle <span class='brand-face'>Nicolas</span> et je suis Directeur de Production chez <a href='http://www.metidia.com'>Metidia</a>.</p><p>Je <a href='/archive'>rédige</a> des articles sur le développement web et la gestion de projets. Je suis <a href='http://www.linkedin.com/profile/view?id=143126897'>LinkedIn</a>, je <a href='https://github.com/nicoespeon/'>code</a> et je <a href='http://twitter.com/nicoespeon'>tweet</a> pas mal aussi.</p></aside><!-- RSS --><aside><p class="text--center"><a href="http://nicoespeon.com/feed.xml"><i class="icon-connection"></i>&nbsp;Restez connectés</a></p></aside><!-- Tweets --><aside class="text--center visuallyhidden--portable"><a class="twitter-timeline" href="https://twitter.com/nicoespeon" data-widget-id="320422386929377280">Tweets de @nicoespeon</a></aside><aside class="visuallyhidden--portable push--top"><h2 class="text--center">Copains</h2><a href="http://iceranking.com">IceRanking.com</a> - (SEO) Cédric Brun, Consultant en Référencement Durable</aside></div></div></div><!-- /container --></div><!-- /main-content --><footer role="contentinfo"><div class="container"><p>&copy; 2015 - <a href="https://twitter.com/nicoespeon">Nicolas (Espeon) Carlo</a><br>Ce site est construit grâce à <a href='https://github.com/mojombo/jekyll'>Jekyll</a> et à <a href='http://inuitcss.com/'>inuit.css</a> de l'excellent <a href='https://twitter.com/csswizardry'>@csswizardry</a>. Le code source est <a href='https://github.com/nicoespeon/nicoespeon.github.io'>hébergé sur GitHub</a>.</p></div></footer><!-- jQuery --><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script>$( function () {/*** This JS code is still small so its better to keep it inline.** Only apply if we are beyond the desk CSS breakpoint on load*/if ( $( window ).width() >= 1024 ) {var $timeline = $( "ul#timeline" );/*** Then hide every label description of the timeline*/$timeline.find( "a.timeline__label" ).each( function () {$( this ).find( "p" ).hide();} );/*** And delegate the visibility effect on hover for each label description*/$timeline.on( "mouseenter mouseleave", "a.timeline__label", function () {$( this ).find( "p" ).stop().toggle( "slow" );} );}} );</script><!-- Twitter API --><script>!function ( d, s, id ) {var js, fjs = d.getElementsByTagName( s )[0];if ( !d.getElementById( id ) ) {js = d.createElement( s );js.id = id;js.src = "//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore( js, fjs );}}( document, "script", "twitter-wjs" );</script><!-- Google Analytics --><script>var _gaq = _gaq || [];_gaq.push( ['_setAccount', 'UA-39957541-2'] );_gaq.push( ['_setDomainName', 'nicoespeon.com'] );_gaq.push( ['_trackPageview'] );(function () {var ga = document.createElement( 'script' );ga.type = 'text/javascript';ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName( 'script' )[0];s.parentNode.insertBefore( ga, s );})();</script><!-- Disqus --><script>var disqus_shortname = 'nicoespeon';var disqus_url = 'http://nicoespeon.com/fr/2014/12/fonctions-privees-backbonejs/';var title = "Fonctions privées avec Backbone.js";(function () {var dsq = document.createElement( 'script' );dsq.type = 'text/javascript';dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName( 'head' )[0] || document.getElementsByTagName( 'body' )[0]).appendChild( dsq );})();</script><noscript>Please enable JavaScript to view the <ahref="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></body></html>