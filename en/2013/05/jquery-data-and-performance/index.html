<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1.0"><meta name="description" content="Best practice and data manipulation with jQuery, no added colourings or preservatives."><meta property="og:site_name" content="@nicoespeon's blog" /><meta property="og:url" content="http://www.nicoespeon.com/en/2013/05/jquery-data-and-performance/" /><meta property="og:type" content="article" /><meta property="og:title" content="jQuery, data and performance | @nicoespeon" /><meta property="og:description" content="Best practice and data manipulation with jQuery, no added colourings or preservatives." /><meta property="og:image" content="https://fr.gravatar.com/userimage/27601663/eb6a327f57a4931bfdf6c213af65ed2d.jpg?size=300" /><title>jQuery, data and performance | @nicoespeon</title><link rel="icon" href="/assets/img/icon.png"><link rel="author" href="https://plus.google.com/u/0/108378377887967941980"><!-- DNS prefetch for external resources --><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//platform.twitter.com"><link rel="dns-prefetch" href="//p.twitter.com"><link rel="dns-prefetch" href="//cdn.api.twitter.com"><link rel="dns-prefetch" href="//google-analytics.com"><link rel="stylesheet"href='http://fonts.googleapis.com/css?family=Snippet|Roboto:300,100,700'><link rel="stylesheet" href="/assets/css/nicoespeon.css" media="screen"><link rel="stylesheet" href="/assets/css/nicoespeon-print.css" media="print"></head><body><div id="site"><div class="container"><div class="grid"><div class="grid__item seven-tenths portable-one-whole" role="main"><header class="media" role="banner"><!-- Brand logo --><img src="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" class="media__img img--circle" alt="My avatar" width="80" height="80"/><!-- Main navigation --><nav class="media__body" role="navigation"><ul class="nav nav--main"><li><a href="/index.html">Home</a></li><li><a href="/about.html">About</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/worth-reading.html">Worth Reading</a></li></ul></nav><!-- /navigation --></header><!-- /header --><article role="main"><h1>jQuery, data and performance</h1><div class="media"><div class="media__img"><a href="https://twitter.com/share" class="twitter-share-button" data-text="jQuery, data and performance |" data-via="nicoespeon">Tweeter</a></div><div class="media__body brand-face zeta">(04 May, 2013)</div></div><p class="islet">Best practice and data manipulation with jQuery, no added colourings or preservatives.</p><h2 id="tldr">TL;DR</h2><p>jQuery makes elements-related data manipulation easy.</p><p>The HTML5 <code>data-*</code> attribute is linked in some way to the jQuery <strong>data</strong> object for DOM elements.</p><p><code>$.data(element, key[, value])</code> deals with DOM elements related data.</p><p><code>$.fn.data(key[, value])</code> deals with jQuery elements related data.</p><p><code>$.data</code> is low-level and executes faster while <code>$.fn.data</code> is much more convenient and flexible. Futhermore, the second one can access to the <code>data-*</code> attributes.</p><div class="highlight"><pre><code class="html"><span class="c">&lt;!-- HTML --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;main-content&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="javascript"><span class="c1">// Javascript</span>
<span class="kd">var</span> <span class="nx">$el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main-content&#39;</span><span class="p">);</span>

<span class="nx">$el</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span>    <span class="c1">// fast</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">$el</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span> <span class="c1">// 10 times faster</span>
</code></pre></div><p>Finally, unlike <code>$.fn.attr</code>, both of these methods don’t modify the DOM.</p><div class="highlight"><pre><code class="javascript"><span class="nx">$el</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span>
    <span class="c1">// &lt;div id=&quot;main-content&quot;&gt;&lt;/div&gt;</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">$el</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span>
    <span class="c1">// &lt;div id=&quot;main-content&quot;&gt;&lt;/div&gt;</span>
<span class="nx">$el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span>
    <span class="c1">// &lt;div id=&quot;main-content&quot; data-key=&quot;plop&quot;&gt;&lt;/div&gt;</span>
</code></pre></div><h2 id="data-manipulation-with-jquery">Data manipulation with jQuery</h2><p>To attach an information to an element and manipulate it over script execution is dead easy with jQuery. Indeed, the library has methods to store, modify and delete data which are related to an element.</p><p>Futhermore, it’s good to know that the <code>data-*</code> attributes introduced with HTML5 are automatically pulled as a jQuery <strong>data</strong> object. Doing so, they are accessible through some of its methods.</p><h4 id="fndata">$.fn.data</h4><p>The most popular method is <code>$.fn.data</code> which is used as below:</p><div class="highlight"><pre><code class="javascript"><span class="c1">// Affects the &quot;plop&quot; string to the &quot;key&quot; key</span>
<span class="nx">elem</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span>

<span class="c1">// Reads the data with the &quot;key&quot; key</span>
<span class="nx">elem</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre><code class="html"><span class="c">&lt;!-- Valid HTML5 code --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;elem&quot;</span> <span class="na">data-my-key=</span><span class="s">&quot;hey&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#elem&#39;</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;myKey&#39;</span><span class="p">);</span> <span class="c1">// Outputs &quot;hey&quot;</span>
</code></pre></div><p class="islet">You'll notice that we remove <code>data-</code> and the HTML hyphens to specify the key the CamelCase way, accordingly to the <a href="http://www.w3.org/TR/html5/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes">W3C specification</a>.</p><p><a href="http://api.jquery.com/data/">The documentation</a> is very simple to get in and gives a good overview of the concept.</p><p>But wait there’s more… use the <code>$.fn.removeData</code> method to clean all that mess:</p><div class="highlight"><pre><code class="javascript"><span class="nx">elem</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">);</span> <span class="c1">// Bye!</span>
</code></pre></div><h4 id="data">$.data</h4><p>The library also comes with a more low-level and less known method, <code>$.data</code>. It plays the same role excepted the syntax and the fact that you need to provide a DOM element associated to the data as a parameter.</p><div class="highlight"><pre><code class="javascript"><span class="c1">// Affects the &quot;plop&quot; string to the &quot;key&quot; key</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span>

<span class="c1">// Reads the data with the &quot;key&quot; key</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">);</span>
</code></pre></div><p>Here again, please have a look to the <a href="http://api.jquery.com/jQuery.data/">official documentation</a>.</p><p>We also get the <code>$.removeData</code> method to remove data and the <code>$.hasData</code> one to check if an element does or doesn’t have data attached:</p><div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">.</span><span class="nx">hasData</span><span class="p">(</span><span class="nx">elem</span><span class="p">);</span>           <span class="c1">// Outputs &quot;true&quot;</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">);</span> <span class="c1">// Bye!</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">hasData</span><span class="p">(</span><span class="nx">elem</span><span class="p">);</span>           <span class="c1">// Outputs &quot;false&quot;</span>
</code></pre></div><h2 id="performance-vs-power">Performance vs. Power</h2><p>Why should I use <code>$.data</code> when <code>$.fn.data</code> is much more sexy to write?</p><p>Well, as the method is low-level, <strong>it goes way faster</strong>!</p><div class="highlight"><pre><code class="javascript"><span class="nx">el</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span>    <span class="c1">// fast</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span> <span class="c1">// up to 10 times faster</span>
</code></pre></div><p>I invite you to <a href="jsperf.com/jquery-fn-data-vs-data">test performances by yourself</a>.</p><p>The other side of the coin is that it should attach data to a DOM element while <code>$.fn.data</code> can handle any sort of jQuery object, events included:</p><div class="highlight"><pre><code class="javascript"><span class="c1">// Affects each link index as a data for the &quot;click&quot; event</span>
<span class="c1">// When you click on a link, it shows its index</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">index</span><span class="o">:</span><span class="nx">i</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;My index is &#39;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">index</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre></div><p>Finally, <code>$.data</code> doesn’t manage HTML5 <code>data-*</code> attributes while <code>$.fn.data</code> does.</p><p>Concretely:- if you deal with an event, use <code>$.fn.data</code>- if you deal with an HTML5 <code>data-*</code> attribute, use <code>$.fn.data</code>- otherwise, use <code>$.data</code> because of performance</p><h2 id="a-word-about-the-dom">A word about the DOM</h2><p>It’s also good to know that both of the <code>$.data</code> and <code>$.fn.data</code> methods <strong>do not modify the DOM</strong>.</p><p>More precisely, although the <code>$.fn.data</code> methods can access to <code>data-*</code> attributes, it wouldn’t modify them in the DOM. You shouldn’t get tricked because of the function abstraction: it’s not the attribute you are manipulating but an automatically created <strong>jQuery object</strong>.</p><p>In return, the <code>$.fn.attr</code> method is an alternative to reach DOM attributes and to modify them.</p><div class="highlight"><pre><code class="html"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;main-content&quot;</span> <span class="na">data-my-key=</span><span class="s">&quot;hey&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main-content&#39;</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;myKey&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span>
    <span class="c1">// Change the jQuery object, not the DOM</span>
    <span class="c1">// &lt;div id=&quot;main-content&quot; data-my-key=&quot;hey&quot;&gt;&lt;/div&gt;</span>
    <span class="c1">// Note: $(&#39;#main-content&#39;).data(&#39;myKey&#39;) outputs &quot;plop&quot;</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main-content&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-my-key&#39;</span><span class="p">,</span> <span class="s1">&#39;plop&#39;</span><span class="p">);</span>
    <span class="c1">// Change effectively the DOM</span>
    <span class="c1">// &lt;div id=&quot;main-content&quot; data-key=&quot;plop&quot;&gt;&lt;/div&gt;</span>
</code></pre></div><p>In the first code, we modified the jQuery object but nothing happen on the HTML.</p><p>In the second code however, we concretely modified the HTML.</p><p>Concerning performance, you might note that <a href="http://jsperf.com/jquery-fn-data-vs-fn-attr">the second is way faster than the first one</a>. A reason for that would probably be that <code>$.fn.data</code> does more than just “reach” the element: it performs some casting regarding to the type of the element.</p><p>Thus, it could be very helpful for plugins or widgets initialization:</p><div class="highlight"><pre><code class="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;widget&quot;</span> <span class="na">data-row=</span><span class="s">&quot;2&quot;</span> <span class="na">data-responsive=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.widget&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">myWidget</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;rows&#39;</span><span class="p">),</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;responsive&#39;</span><span class="p">)</span>
    <span class="p">);</span>
<span class="p">});</span>
</code></pre></div><p>On the other hand, <code>$.fn.attr</code> will always output a string, which could be necessary sometimes.</p><h2 id="last-words">Last words</h2><p>That’s it for my short (but intense!) presentation of existing jQuery methods to manipulate data.</p><p>I thought that notes about performance would have been interesting, but it shouldn’t be a concern: this is not what would make you script significantly faster. Still, it’s good to know about it!</p><p>If I’m lucky enough, that may have been one of your <em>“Aha moment”</em> with JS (<a href="http://hugogiraudel.com/2013/04/30/css-aha-moment/">as some people would call that</a>) =)</p><p>Plop!</p><div id="disqus_thread" role="complementary"></div></article></div><div class="grid__item three-tenths portable-one-whole"role="complementary"><!-- Lang navigation --><nav role="navigation"><ul class="nav nav--stacked text--center"><li class="current" ><a href="/">English version</a></li><li ><a href="/fr/">Version française</a></li></ul></nav><!-- About --><aside class="text--justify"><p>My name is <span class='brand-face'>Nicolas</span> and I'm a french Consultant at <a href='http://www.octo.com/'>OCTO Technology</a>.</p><p>I <a href='/archive'>write</a> posts about web development and project management. I got <a href='http://www.linkedin.com/profile/view?id=143126897'>LinkedIn</a>, I <a href='https://github.com/nicoespeon/'>code</a> and I <a href='http://twitter.com/nicoespeon'>tweet</a> too.</p><p>I tend to <a href='https://medium.com/@nicoespeon'>post on Medium</a> now, in case you want to keep updated ;-)</p></aside><!-- RSS --><aside><p class="text--center"><a href="http://www.nicoespeon.com/feed.xml"><i class="icon-connection"></i>&nbsp;Stay tuned</a></p></aside><!-- Tweets --><aside class="text--center visuallyhidden--portable"><a class="twitter-timeline" href="https://twitter.com/nicoespeon" data-widget-id="320422386929377280">Tweets de @nicoespeon</a></aside><aside class="visuallyhidden--portable push--top"><h2 class="text--center">Friends</h2><a href="http://iceranking.com">IceRanking.com</a> - (SEO) Cédric Brun, Consultant en Référencement Durable</aside></div></div></div><!-- /container --></div><!-- /main-content --><footer role="contentinfo"><div class="container"><p>&copy; 2017 - <a href="https://twitter.com/nicoespeon">Nicolas (Espeon) Carlo</a><br>The website is built upon <a href='https://github.com/mojombo/jekyll'>Jekyll</a> and <a href='http://inuitcss.com/'>inuit.css</a> from the excellent <a href='https://twitter.com/csswizardry'>@csswizardry</a>. Source code is <a href='https://github.com/nicoespeon/nicoespeon.github.io'>hosted on GitHub</a>.</p></div></footer><!-- jQuery --><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script>$( function () {/*** This JS code is still small so its better to keep it inline.** Only apply if we are beyond the desk CSS breakpoint on load*/if ( $( window ).width() >= 1024 ) {var $timeline = $( "ul#timeline" );/*** Then hide every label description of the timeline*/$timeline.find( "a.timeline__label" ).each( function () {$( this ).find( "p" ).hide();} );/*** And delegate the visibility effect on hover for each label description*/$timeline.on( "mouseenter mouseleave", "a.timeline__label", function () {$( this ).find( "p" ).stop().toggle( "slow" );} );}/*** Append anchor to page subtitles with IDs (used for blog posts).*/$( "h2[id], h3[id]" ).each( function () {var $title = $( this );var $anchor = $( "<a href='#" + $title.attr( "id" ) + "' class='anchor'><i class='icon-link'></i></a>" );$title.append( $anchor );} );} );</script><!-- Twitter API --><script>!function ( d, s, id ) {var js, fjs = d.getElementsByTagName( s )[0];if ( !d.getElementById( id ) ) {js = d.createElement( s );js.id = id;js.src = "//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore( js, fjs );}}( document, "script", "twitter-wjs" );</script><!-- Google Analytics --><script>var _gaq = _gaq || [];_gaq.push( ['_setAccount', 'UA-39957541-2'] );_gaq.push( ['_setDomainName', 'nicoespeon.com'] );_gaq.push( ['_trackPageview'] );(function () {var ga = document.createElement( 'script' );ga.type = 'text/javascript';ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName( 'script' )[0];s.parentNode.insertBefore( ga, s );})();</script><!-- Disqus --><script>var disqus_shortname = 'nicoespeon';var disqus_url = 'http://nicoespeon.com/en/2013/05/jquery-data-and-performance/';var title = "jQuery, data and performance";(function () {var dsq = document.createElement( 'script' );dsq.type = 'text/javascript';dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName( 'head' )[0] || document.getElementsByTagName( 'body' )[0]).appendChild( dsq );})();</script><noscript>Please enable JavaScript to view the <ahref="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></body></html>