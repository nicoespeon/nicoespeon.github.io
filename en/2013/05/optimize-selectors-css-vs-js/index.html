<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1.0"><meta name="description" content="Short round up of best practices for selectors use in CSS and Javascript. What is sauce for the goose is not necessarily sauce for the gander."><meta property="og:site_name" content="@nicoespeon's blog" /><meta property="og:url" content="http://www.nicoespeon.com/en/2013/05/optimize-selectors-css-vs-js/" /><meta property="og:type" content="article" /><meta property="og:title" content="Optimize selectors, CSS vs. JS | @nicoespeon" /><meta property="og:description" content="Short round up of best practices for selectors use in CSS and Javascript. What is sauce for the goose is not necessarily sauce for the gander." /><meta property="og:image" content="https://fr.gravatar.com/userimage/27601663/eb6a327f57a4931bfdf6c213af65ed2d.jpg?size=300" /><title>Optimize selectors, CSS vs. JS | @nicoespeon</title><link rel="icon" href="/assets/img/icon.png"><link rel="author" href="https://plus.google.com/u/0/108378377887967941980"><!-- DNS prefetch for external resources --><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//platform.twitter.com"><link rel="dns-prefetch" href="//p.twitter.com"><link rel="dns-prefetch" href="//cdn.api.twitter.com"><link rel="dns-prefetch" href="//google-analytics.com"><link rel="stylesheet"href='http://fonts.googleapis.com/css?family=Snippet|Roboto:300,100,700'><link rel="stylesheet" href="/assets/css/nicoespeon.css" media="screen"><link rel="stylesheet" href="/assets/css/nicoespeon-print.css" media="print"></head><body><div id="site"><div class="container"><div class="grid"><div class="grid__item seven-tenths portable-one-whole" role="main"><header class="media" role="banner"><!-- Brand logo --><img src="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" class="media__img img--circle" alt="My avatar" width="80" height="80"/><!-- Main navigation --><nav class="media__body" role="navigation"><ul class="nav nav--main"><li><a href="/index.html">Home</a></li><li><a href="/about.html">About</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/worth-reading.html">Worth Reading</a></li></ul></nav><!-- /navigation --></header><!-- /header --><article role="main"><h1>Optimize selectors, CSS vs. JS</h1><div class="media"><div class="media__img"><a href="https://twitter.com/share" class="twitter-share-button" data-text="Optimize selectors, CSS vs. JS |" data-via="nicoespeon">Tweeter</a></div><div class="media__body brand-face zeta">(02 May, 2013)</div></div><p class="islet">Short round up of best practices for selectors use in CSS and Javascript. What is sauce for the goose is not necessarily sauce for the gander.</p><h2 id="tldr">TL;DR</h2><p>Selectors are interpreted <strong>from right to left</strong>.</p><p><strong>With CSS</strong>, it’s better to use a class instead of an identifier as the first one can do exactly the same than the second one, and more. You have to keep the specificity as low as possible to improve code scalability.</p><p><strong>With JS</strong>, an identifier and an high specificity will lead to more efficient results. You’ve to go straight to the point. But it’s pointless to be over-specific, it’s counter-productive.</p><p><strong>Don’t use the universal selector <code>*</code> in a selector chain</strong>.</p><p>Both are not mutually exclusive and do not prevent your HTML to be semantic:</p><div class="highlight"><pre><code class="html"><span class="c">&lt;!-- HTML --&gt;</span>
<span class="nt">&lt;article</span> <span class="na">id=</span><span class="s">&quot;main-article&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;ol</span> <span class="na">role=</span><span class="s">&quot;navigation&quot;</span> <span class="na">class=</span><span class="s">&quot;nav nav--block pagination&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;pagination__prev&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/page1&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span> Previous<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;pagination__next&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/page3&quot;</span><span class="nt">&gt;</span>Next <span class="ni">&amp;gt;</span><span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/ol&gt;</span>
<span class="nt">&lt;/article&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="css"><span class="c">/* CSS */</span>
<span class="nc">.nav</span> <span class="p">{</span>
    <span class="k">list-style</span><span class="o">:</span><span class="k">none</span><span class="p">;</span>
    <span class="k">margin-left</span><span class="o">:</span><span class="m">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.nav--block</span> <span class="p">{</span>
    <span class="k">line-height</span><span class="o">:</span><span class="m">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Bad idea */</span>
<span class="nc">.nav--block</span> <span class="o">*</span> <span class="p">{</span>
    <span class="k">color</span><span class="o">:</span> <span class="nb">red</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Not a big deal */</span>
<span class="o">*</span> <span class="p">{</span>
    <span class="n">box</span><span class="o">-</span><span class="n">sizing</span><span class="o">:</span> <span class="k">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="js"><span class="c1">// Javascript (jQuery)</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main-article .nav--block .pagination__prev&#39;</span><span class="p">);</span>   <span class="c1">// fast</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main-article .nav--block li.pagination__prev&#39;</span><span class="p">);</span> <span class="c1">// faster</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main-article&#39;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.pagination__prev&#39;</span><span class="p">);</span>       <span class="c1">// super-fast</span>
</code></pre></div><h2 id="with-css">With CSS</h2><p class="islet">This come from CSS best practices known as OOCSS (<em>Object Oriented CSS</em>). It's a fairly generalized philosophy I agree with, but it's not the only way. However, I trust it could be used for any kind of project, regardless its size, with a <em>future-proof</em> argument.<br /><br /><a href="http://coding.smashingmagazine.com/2011/12/12/an-introduction-to-object-oriented-css-oocss/">Here is an introduction to OOCSS principles</a> for those who are interested in. <a href="http://coding.smashingmagazine.com/2012/06/19/classes-where-were-going-we-dont-need-classes/">This is an alternative vision</a> I don't share but which is legit still. Feel free to follow your own path.</p><h4 id="class-or-id-">Class or ID ?</h4><p>In short, from CSS point of view <strong>a class can do whatever an identifier does, but an identifier cannot be reused</strong>.</p><p>That said, we can use classes instead of identifier and anticipate the future.</p><p>Furthermore, an identifier considerably increase the declaration specificity. This will make your CSS a mess with inappropriate uses of <code>!important</code> or other inline style declarations directly within the HTML to override the desired style.</p><div class="highlight"><pre><code class="html"><span class="c">&lt;!-- Not really future-proof --&gt;</span>
<span class="nt">&lt;ol</span> <span class="na">id=</span><span class="s">&quot;pagination&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/page1&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span> Previous<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/page3&quot;</span><span class="nt">&gt;</span>Next <span class="ni">&amp;gt;</span><span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ol&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="css"><span class="nf">#pagination</span> <span class="p">{</span>
    <span class="k">list-style</span><span class="o">:</span><span class="k">none</span><span class="p">;</span>
    <span class="k">margin-left</span><span class="o">:</span><span class="m">0</span><span class="p">;</span>
    <span class="k">line-height</span><span class="o">:</span><span class="m">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>What if another type of pagination appears somewhere else on the page? Do we create a completely new identifier with kind of the same properties? However, pagination sounds like some kind of navigation, doesn’t it?</p><div class="highlight"><pre><code class="html"><span class="c">&lt;!-- Future-proof --&gt;</span>
<span class="nt">&lt;ol</span> <span class="na">class=</span><span class="s">&quot;nav pagination&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/page1&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span> Previous<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/page3&quot;</span><span class="nt">&gt;</span>Next <span class="ni">&amp;gt;</span><span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ol&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="css"><span class="nc">.nav</span> <span class="p">{</span>
    <span class="k">list-style</span><span class="o">:</span><span class="k">none</span><span class="p">;</span>
    <span class="k">margin-left</span><span class="o">:</span><span class="m">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.pagination</span> <span class="p">{</span>
    <span class="k">line-height</span><span class="o">:</span><span class="m">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>The <code>.nav</code> class is perfectly reusable. It’s an abstract layer which determine the common properties to all the <em>navigation</em> menu of my website.</p><h4 id="bewaaaaare-specificity">Bewaaaaare specificity!</h4><p>With CSS, <a href="http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/">the specificity rules</a> are more or less easy to figure out, more or less known and lead to more or less problems whether our CSS is more or less cleverly written.</p><p>In a few words: <strong>don’t write over-specified selectors which make rules unnecessarily heavy</strong>.</p><p>It’s about OOCSS spirit: classes are more or less abstracts objects you can combine as lego to produce the expected output. It’s much more stable and scalable over time!</p><div class="highlight"><pre><code class="css"><span class="nt">ol</span><span class="nc">.nav</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>              <span class="c">/* 0-0-1-1 useless specification */</span>
<span class="nt">article</span> <span class="o">&gt;</span> <span class="nc">.nav</span> <span class="nt">li</span> <span class="nt">a</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span> <span class="c">/* 0-0-1-3 too specific! */</span>
<span class="nc">.pagination__prev</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>   <span class="c">/* 0-0-1-0 OK */</span>
</code></pre></div><p>The deal is to produce an efficient CSS because:- it’s <a href="http://en.wikipedia.org/wiki/Loose_coupling">loosely coupled</a> with the HTML context (flexibility)- it could be easily override (scalability)- plus, it’s easy to figure out</p><p>The use of <code>!important</code> to set a style <em>“becoz’, otherwise, it duzn’t work and we dun’t know why”</em> is a good indicator of a poor-quality CSS.</p><p>If you’re not a really good numbers person, <a href="http://css-specificity.webapp-prototypes.appspot.com/">here is an online CSS specificity calculator</a> which can help you. The deal is to keep a specificity close to <code>[0-0-1-0]</code>, which is equivalent to a class. Doing so, you won’t lose time anymore in debugging why your style doesn’t apply.</p><h2 id="with-javascript">With Javascript</h2><p class="islet"><strong>NB</strong> - <em>Javascript</em> is an abuse of terms. I mainly deal with JS libraries, jQuery as a reference.<br /><br />It worth noting that vanilla JS will give better results and <code>document.getElementById()</code> is probably <a href="http://jsperf.com/id-selector-comparison/3">the most efficient</a>.</p><h4 id="a-good-id">A good ID</h4><p>An identifier is the most efficient of selectors. Once the selector engine has found the element, it stops its journey through the DOM. The use of an identifier is relevant with Javascript because we want to deal with a precise, identified element most of the time.</p><p>In short, it’s much more efficient to <strong>isolate the identifier within the selector</strong>, then to chain with a query function to limit the scope for the engine:</p><div class="highlight"><pre><code class="js"><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main-article .pagination__prev&#39;</span><span class="p">);</span>         <span class="c1">// fast</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main-article&#39;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.pagination__prev&#39;</span><span class="p">);</span> <span class="c1">// 2 times faster</span>
</code></pre></div><p>In the first attempt, the engine will search for all the elements from the DOM with the <code>.pagination__prev</code> class, then search for those who are inside the <code>#main-article</code> block.</p><p>In the second attempt, the engine will first search for the <code>#main-article</code> block, then for elements with the <code>.pagination__prev</code> class inside this block.</p><p>Please <a href="http://jsperf.com/optimized-js-selectors">check performances by yourself</a>.</p><h4 id="specific-enough">Specific enough</h4><p>This is a small bullet point worth noting. To <strong>increase the specificity at the right of the selector</strong> could increase the speed of the selector engine.</p><p>However, it’s pointless and counter-productive to make your selector far too heavy than necessary.</p><div class="highlight"><pre><code class="js"><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;ol.nav--block .muted&#39;</span><span class="p">);</span>                    <span class="c1">// not-optimized</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.nav--block li.pagination__next a.muted&#39;</span><span class="p">);</span> <span class="c1">// not-optimized</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.nav--block a.muted&#39;</span><span class="p">);</span>                     <span class="c1">// optimized</span>
</code></pre></div><h2 id="be-careful-with-the-universal-selector">Be careful with the universal selector</h2><p class="islet">Updated on May 4th, 2013 after an <a href="http://paulirish.com/2012/box-sizing-border-box-ftw/">insightful reading</a> about the use of <code>*</code> in CSS and its performance impact (the performance paragraph).</p><p>Whether it is with CSS or JS, <code>*</code> could be the bugbear of selection performance.</p><p>Improperly used with CSS or, without knowing it, in JS selectors, this is the worst thing the selector engine could have to deal with, as it should check against all the DOM elements.</p><p><strong>In CSS</strong>, ask yourself: do I really need to point out all the elements, whatever they are? “No” would probably be the answer.</p><p>This, is a bad idea:</p><div class="highlight"><pre><code class="css"><span class="nc">.nav--block</span> <span class="o">*</span> <span class="p">{</span>
    <span class="k">color</span><span class="o">:</span> <span class="nb">red</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>When you read <em>“within <code>.nav--block</code> elements, all the elements”</em>, the selector engine read <em>“all the elements, then those who have <code>.nav--block</code> as a parent”</em>. From the right to the left!</p><p>However, this won’t lead to performance leak and shouldn’t be a concern excepted if you try to improve your <a href="https://developers.google.com/speed/pagespeed">Page Speed</a> score beyond 90 :</p><div class="highlight"><pre><code class="css"><span class="c">/* apply a natural box layout model to all elements */</span>
<span class="o">*</span> <span class="p">{</span>
    <span class="o">-</span><span class="n">moz</span><span class="o">-</span><span class="n">box</span><span class="o">-</span><span class="n">sizing</span><span class="o">:</span> <span class="k">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
    <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">box</span><span class="o">-</span><span class="n">sizing</span><span class="o">:</span> <span class="k">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
    <span class="n">box</span><span class="o">-</span><span class="n">sizing</span><span class="o">:</span> <span class="k">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p><strong>In JS</strong>, if you don’t pay attention you’ll make it implicit by default. Plus, there should be alternative functions to achieve what you want to do.</p><div class="highlight"><pre><code class="js"><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.nav--block &gt; *&#39;</span><span class="p">);</span>         <span class="c1">// ouch!</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.nav--block&#39;</span><span class="p">).</span><span class="nx">children</span><span class="p">();</span>  <span class="c1">// better</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.form-fields :radio&#39;</span><span class="p">);</span>      <span class="c1">// = $(&#39;.form-fields *:radio&#39;);</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.form-fields input:radio&#39;</span><span class="p">);</span> <span class="c1">// better</span>
</code></pre></div><h2 id="last-words">Last words</h2><p>That’s it folks, that was my point of view over selectors.</p><p>These are best practices I learnt over time. It’s completely open to discuss, do not hesitate to do remarks, questions or suggestions below =)</p><p>Plop !</p><div id="disqus_thread" role="complementary"></div></article></div><div class="grid__item three-tenths portable-one-whole"role="complementary"><!-- Lang navigation --><nav role="navigation"><ul class="nav nav--stacked text--center"><li class="current" ><a href="/">English version</a></li><li ><a href="/fr/">Version française</a></li></ul></nav><!-- About --><aside class="text--justify"><p>My name is <span class='brand-face'>Nicolas</span> and I'm a french Consultant at <a href='http://www.octo.com/'>OCTO Technology</a>.</p><p>I <a href='/archive'>write</a> posts about web development and project management. I got <a href='https://www.linkedin.com/in/nicolas-carlo-095b243b/'>LinkedIn</a>, I <a href='https://github.com/nicoespeon/'>code</a> and I <a href='http://twitter.com/nicoespeon'>tweet</a> too.</p><p>I tend to <a href='https://medium.com/@nicoespeon'>post on Medium</a> now, in case you want to keep updated ;-)</p></aside><!-- RSS --><aside><p class="text--center"><a href="http://www.nicoespeon.com/feed.xml"><i class="icon-connection"></i>&nbsp;Stay tuned</a></p></aside><!-- Tweets --><aside class="text--center visuallyhidden--portable"><a class="twitter-timeline" href="https://twitter.com/nicoespeon" data-widget-id="320422386929377280">Tweets de @nicoespeon</a></aside><aside class="visuallyhidden--portable push--top"><h2 class="text--center">Friends</h2><a href="http://iceranking.com">IceRanking.com</a> - (SEO) Cédric Brun, Consultant en Référencement Durable</aside></div></div></div><!-- /container --></div><!-- /main-content --><footer role="contentinfo"><div class="container"><p>&copy; 2017 - <a href="https://twitter.com/nicoespeon">Nicolas (Espeon) Carlo</a><br>The website is built upon <a href='https://github.com/mojombo/jekyll'>Jekyll</a> and <a href='http://inuitcss.com/'>inuit.css</a> from the excellent <a href='https://twitter.com/csswizardry'>@csswizardry</a>. Source code is <a href='https://github.com/nicoespeon/nicoespeon.github.io'>hosted on GitHub</a>.</p></div></footer><!-- jQuery --><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script>$( function () {/*** This JS code is still small so its better to keep it inline.** Only apply if we are beyond the desk CSS breakpoint on load*/if ( $( window ).width() >= 1024 ) {var $timeline = $( "ul#timeline" );/*** Then hide every label description of the timeline*/$timeline.find( "a.timeline__label" ).each( function () {$( this ).find( "p" ).hide();} );/*** And delegate the visibility effect on hover for each label description*/$timeline.on( "mouseenter mouseleave", "a.timeline__label", function () {$( this ).find( "p" ).stop().toggle( "slow" );} );}/*** Append anchor to page subtitles with IDs (used for blog posts).*/$( "h2[id], h3[id]" ).each( function () {var $title = $( this );var $anchor = $( "<a href='#" + $title.attr( "id" ) + "' class='anchor'><i class='icon-link'></i></a>" );$title.append( $anchor );} );} );</script><!-- Twitter API --><script>!function ( d, s, id ) {var js, fjs = d.getElementsByTagName( s )[0];if ( !d.getElementById( id ) ) {js = d.createElement( s );js.id = id;js.src = "//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore( js, fjs );}}( document, "script", "twitter-wjs" );</script><!-- Google Analytics --><script>var _gaq = _gaq || [];_gaq.push( ['_setAccount', 'UA-39957541-2'] );_gaq.push( ['_setDomainName', 'nicoespeon.com'] );_gaq.push( ['_trackPageview'] );(function () {var ga = document.createElement( 'script' );ga.type = 'text/javascript';ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName( 'script' )[0];s.parentNode.insertBefore( ga, s );})();</script><!-- Disqus --><script>var disqus_shortname = 'nicoespeon';var disqus_url = 'http://nicoespeon.com/en/2013/05/optimize-selectors-css-vs-js/';var title = "Optimize selectors, CSS vs. JS";(function () {var dsq = document.createElement( 'script' );dsq.type = 'text/javascript';dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName( 'head' )[0] || document.getElementsByTagName( 'body' )[0]).appendChild( dsq );})();</script><noscript>Please enable JavaScript to view the <ahref="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></body></html>
