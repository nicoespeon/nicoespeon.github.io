<!DOCTYPE html><html lang="en" xmlns:og="http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1.0"><meta name="description" content="With JavaScript you get a more object-oriented, less procedural and error-prone alternative to the good 'ol <code>switch … case</code>."><meta property="og:title" content="OOP - switch revisited in JavaScript | @nicoespeon" /><meta property="og:type" content="article" /><meta property="og:description" content="With JavaScript you get a more object-oriented, less procedural and error-prone alternative to the good 'ol <code>switch … case</code>." /><meta property="og:image" content="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" /><title>OOP - switch revisited in JavaScript | @nicoespeon</title><link rel="icon" href="/assets/img/icon.png"><link rel="author" href="https://plus.google.com/u/0/108378377887967941980"><!-- DNS prefetch for external resources --><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//platform.twitter.com"><link rel="dns-prefetch" href="//p.twitter.com"><link rel="dns-prefetch" href="//cdn.api.twitter.com"><link rel="dns-prefetch" href="//google-analytics.com"><link rel="stylesheet"href='http://fonts.googleapis.com/css?family=Snippet|Roboto:300,100,700'><link rel="stylesheet" href="/assets/css/nicoespeon.css" media="screen"><link rel="stylesheet" href="/assets/css/nicoespeon-print.css" media="print"></head><body><div id="site"><div class="container"><div class="grid"><div class="grid__item seven-tenths portable-one-whole" role="main"><header class="media" role="banner"><!-- Brand logo --><img src="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" class="media__img img--circle" alt="My avatar" width="80" height="80"/><!-- Main navigation --><nav class="media__body" role="navigation"><ul class="nav nav--main"><li><a href="/index.html">Home</a></li><li><a href="/about.html">About</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/worth-reading.html">Worth Reading</a></li></ul></nav><!-- /navigation --></header><!-- /header --><article role="main"><h1>OOP - switch revisited in JavaScript</h1><div class="media"><a href="https://twitter.com/share" class="twitter-share-button media__img--rev" data-text="OOP - switch revisited in JavaScript |" data-via="nicoespeon">Tweeter</a><div class="media__body brand-face zeta">(14 January, 2015)</div></div><p class="islet">With JavaScript you get a more object-oriented, less procedural and error-prone alternative to the good 'ol <code>switch … case</code>.</p><p>Suppose following methods for the rest of the post:</p><div class='highlight'><pre><code class='javascript'><span class='kd'>function</span> <span class='nx'>sayHello</span> <span class='p'>()</span> <span class='p'>{</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span> <span class='s2'>&quot;Hello, how are you?&quot;</span> <span class='p'>);</span>
<span class='p'>}</span>

<span class='kd'>function</span> <span class='nx'>giveSomeNews</span> <span class='p'>()</span> <span class='p'>{</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span> <span class='s2'>&quot;Roses are red. Did you know that?&quot;</span> <span class='p'>);</span>
<span class='p'>}</span>

<span class='kd'>function</span> <span class='nx'>sayBye</span> <span class='p'>()</span> <span class='p'>{</span>
  <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span><span class='p'>(</span> <span class='s2'>&quot;Ok bye!&quot;</span> <span class='p'>);</span>
<span class='p'>}</span>
</code></pre></div><h2 id="few_reminders_about_">Few reminders about <code>switch</code></h2><p><code>if / else</code> allow us to add some branching logic in our code: regarding a condition we’ll do this or that operation. But there are sometimes more than 2 possibles branches.</p><p>As a beginner developer, you might be starting using <code>else if</code>:</p><div class='highlight'><pre><code class='javascript'><span class='k'>if</span><span class='p'>(</span> <span class='nx'>name</span> <span class='o'>===</span> <span class='s2'>&quot;patrick&quot;</span> <span class='p'>)</span> <span class='p'>{</span>
  <span class='nx'>sayHello</span><span class='p'>();</span>
<span class='p'>}</span> <span class='k'>else</span> <span class='k'>if</span><span class='p'>(</span> <span class='nx'>name</span> <span class='o'>===</span> <span class='s2'>&quot;jane&quot;</span> <span class='p'>)</span> <span class='p'>{</span>
  <span class='nx'>giveSomeNews</span><span class='p'>();</span>
<span class='p'>}</span> <span class='k'>else</span> <span class='p'>{</span>
  <span class='nx'>sayBye</span><span class='p'>();</span> <span class='c1'>// don&#39;t talk to strangers!</span>
<span class='p'>}</span>
</code></pre></div><p>Well, that’s a bit verbose, difficult to read and not that pretty. Here comes <code>switch</code>:</p><div class='highlight'><pre><code class='javascript'><span class='k'>switch</span><span class='p'>(</span> <span class='nx'>name</span> <span class='p'>)</span> <span class='p'>{</span>
<span class='k'>case</span> <span class='s2'>&quot;patrick&quot;</span><span class='o'>:</span>
  <span class='nx'>sayHello</span><span class='p'>();</span>
  <span class='k'>break</span><span class='p'>;</span>

<span class='k'>case</span> <span class='s2'>&quot;jane&quot;</span><span class='o'>:</span>
  <span class='nx'>giveSomeNews</span><span class='p'>();</span>
  <span class='k'>break</span><span class='p'>;</span>

<span class='k'>default</span><span class='o'>:</span>
  <span class='nx'>sayBye</span><span class='p'>();</span> <span class='c1'>// don&#39;t talk to strangers!</span>
  <span class='k'>break</span><span class='p'>;</span>
<span class='p'>}</span>
</code></pre></div><p><code>switch</code> is the classical alternative to a long chain of <code>else if</code>.</p><p class='islet'>Excepted for very short operations — few lines with clear intent — I prefer to encapsulate them in <strong>explicitly named</strong> functions to decompose the logic from the implementation details. The logic lies in the <code>switch</code>. I use the same technique for <code>if / else</code>.</p><p>Syntax is clearer, but you’re introducing few subtleties.</p><p>Most of all, you should be aware of the <code>break</code> concept here: it allows you to get out of the <code>switch</code> and prevent falling through the next <code>case</code>.</p><h3 id="remember_errors_to_avoid">Remember errors to avoid!</h3><p>When you deal with a <code>switch</code>, you’re not likely to expect falling through 2 different cases.</p><p>Just like <code>else if</code>, you probably expect to execute one and only one case. That’s why you must take care <strong>not to forget the <code>break</code></strong>!</p><p>Have a look at this code, is it intentional? Is it a mistake? Whatever, that’s a source of bugs and confusion!</p><div class='highlight'><pre><code class='javascript'><span class='k'>switch</span><span class='p'>(</span> <span class='nx'>name</span> <span class='p'>)</span> <span class='p'>{</span>
<span class='k'>case</span> <span class='s2'>&quot;patrick&quot;</span><span class='o'>:</span>
  <span class='nx'>sayHello</span><span class='p'>();</span>
  <span class='k'>break</span><span class='p'>;</span>

<span class='k'>case</span> <span class='s2'>&quot;jane&quot;</span><span class='o'>:</span>
  <span class='nx'>giveSomeNews</span><span class='p'>();</span>

<span class='k'>default</span><span class='o'>:</span>
  <span class='nx'>sayBye</span><span class='p'>();</span> <span class='c1'>// don&#39;t talk to strangers!</span>
  <span class='k'>break</span><span class='p'>;</span>
<span class='p'>}</span>
</code></pre></div><p>There might exists a use case however, where the intent is clear and which is acceptable — and used.</p><p>That’s when you want to regroup multiple inputs into the same <code>case</code>:</p><div class='highlight'><pre><code class='javascript'><span class='k'>switch</span><span class='p'>(</span> <span class='nx'>name</span> <span class='p'>)</span> <span class='p'>{</span>
<span class='k'>case</span> <span class='s2'>&quot;patrick&quot;</span><span class='o'>:</span>
  <span class='nx'>sayHello</span><span class='p'>();</span>
  <span class='k'>break</span><span class='p'>;</span>

<span class='k'>case</span> <span class='s2'>&quot;jane&quot;</span><span class='o'>:</span>
<span class='k'>case</span> <span class='s2'>&quot;john&quot;</span><span class='o'>:</span>
  <span class='nx'>giveSomeNews</span><span class='p'>();</span>
  <span class='k'>break</span><span class='p'>;</span>

<span class='k'>default</span><span class='o'>:</span>
  <span class='nx'>sayBye</span><span class='p'>();</span> <span class='c1'>// don&#39;t talk to strangers!</span>
  <span class='k'>break</span><span class='p'>;</span>
<span class='p'>}</span>
</code></pre></div><p>To keep it short: to omit a <code>break</code> for each <code>case</code> is error-prone because you’re introducing obscure subtleties in your code. And your code is likely to get future developers into troubles.</p><p>That’s why the wise advice is: avoid doing that, do remember the <code>break</code>.</p><h2 id="an_objectoriented_alternative_method_lookup">An object-oriented alternative: method lookup</h2><p>Let’s go back to our example with a less procedural spirit. Let’s get object-oriented:</p><div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>greetings</span> <span class='o'>=</span> <span class='p'>{</span>
  <span class='s2'>&quot;patrick&quot;</span><span class='o'>:</span> <span class='nx'>sayHello</span><span class='p'>,</span>
  <span class='s2'>&quot;john&quot;</span><span class='o'>:</span> <span class='nx'>giveSomeNews</span><span class='p'>,</span>
  <span class='s2'>&quot;jane&quot;</span><span class='o'>:</span> <span class='nx'>giveSomeNews</span>
<span class='p'>};</span>

<span class='p'>(</span><span class='k'>typeof</span> <span class='nx'>greetings</span><span class='p'>[</span> <span class='nx'>name</span> <span class='p'>]</span><span class='err'> </span><span class='o'>===</span> <span class='s2'>&quot;function&quot;</span><span class='p'>)</span>
  <span class='o'>?</span> <span class='nx'>greetings</span><span class='p'>[</span> <span class='nx'>name</span> <span class='p'>]()</span>
  <span class='o'>:</span> <span class='nx'>sayBye</span><span class='p'>();</span>
</code></pre></div><p>You can call that the <strong>method lookup</strong>, which reflect the idea behind the <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/#commandpatternjavascript">Command Pattern</a>.</p><p>We use the natural object syntax of JavaScript and the power of its first-class functions. No <code>break</code> to deal with. We already get all the advantages of the object, as the capability to extend it with ease, allowing context-relative options.</p><p>The method lookup is much more relevant than the switch if you’re in one of the following cases:</p><ul><li>will you need to add more cases later? <em>Dealing with plugins for instance.</em></li><li>is it useful to change cases during run-time? <em>Like changing options regarding the context.</em></li><li>is it useful to log executed cases? <em>To set up an undo / redo stack, a log system, etc.</em></li><li>are you using incremental numbers to list your cases iteratively? <em>If you use <code>case 1:</code>, <code>case 2:</code>, etc.</em></li><li>are you trying to fall through different cases by intentionally omitting some <code>break</code>? <em>Fall through = danger, method lookup is a much better alternative.</em></li></ul><h2 id="few_remarks_on_an_advanced_version_of_">Few remarks on an “advanced” version of <code>switch</code></h2><p>Using <code>switch</code>, you can directly test a condition in your <code>case</code>.</p><p>Doing so, and considering this code exist:</p><div class='highlight'><pre><code class='javascript'><span class='kd'>function</span> <span class='nx'>isPatrick</span> <span class='p'>(</span> <span class='nx'>name</span> <span class='p'>)</span> <span class='p'>{</span>
  <span class='k'>return</span> <span class='p'>(</span><span class='nx'>name</span> <span class='o'>===</span> <span class='s2'>&quot;patrick&quot;</span><span class='p'>);</span>
<span class='p'>}</span>

<span class='kd'>function</span> <span class='nx'>isJane</span> <span class='p'>(</span> <span class='nx'>name</span> <span class='p'>)</span> <span class='p'>{</span>
  <span class='k'>return</span> <span class='sr'>/^jane-/</span><span class='p'>.</span><span class='nx'>test</span><span class='p'>(</span> <span class='nx'>name</span> <span class='p'>);</span>
<span class='p'>}</span>
</code></pre></div><p>Then, the following code will perfectly work:</p><div class='highlight'><pre><code class='javascript'><span class='k'>switch</span><span class='p'>(</span> <span class='kc'>true</span> <span class='p'>)</span> <span class='p'>{</span>
<span class='k'>case</span> <span class='nx'>isPatrick</span><span class='p'>(</span> <span class='nx'>name</span> <span class='p'>)</span><span class='o'>:</span>
  <span class='nx'>sayHello</span><span class='p'>();</span>
  <span class='k'>break</span><span class='p'>;</span>

<span class='k'>case</span> <span class='nx'>isJane</span><span class='p'>(</span> <span class='nx'>name</span> <span class='p'>)</span><span class='o'>:</span>
  <span class='nx'>giveSomeNews</span><span class='p'>();</span>
  <span class='k'>break</span><span class='p'>;</span>

<span class='k'>default</span><span class='o'>:</span>
  <span class='nx'>sayBye</span><span class='p'>();</span> <span class='c1'>// don&#39;t talk to strangers!</span>
  <span class='k'>break</span><span class='p'>;</span>
<span class='p'>}</span>
</code></pre></div><p class='islet'>Again, for more readability I exported conditions into functions that make the intent clear and produce a better code.<br /><br />You'll agree that the logic is now a bit more complex. In such a context, it might be relevant to polish your work <strong>to make your code clear</strong>.</p><p>This works and could be very useful. Plus, it doesn’t have any equivalent with the method lookup as far as I know.</p><p>However, <strong>beware overlogic abuse in your code</strong>. The fact you can do it doesn’t imply that you should. Keep a critical mind over what you’re doing: is it really necessary or is there another simpler way? Can I work on a clearer design to express the logic intent?</p><p>Sometimes you might go crazy into “sexy” stuff, but nothing values most than <strong>KISS</strong>!</p><h2 id="release_the_objectoriented_kraken">Release the (object-oriented) Kraken!</h2><p>The <em>method lookup / command pattern</em> is a <code>switch</code> equivalent, with an object-oriented spirit. <strong>It tends to encourage you to write a flexible, well-organized, object-oriented code</strong> — which is good.</p><p><code>switch … case</code> is not a bad thing in itself. But it can be lead to <em>spaghetti code</em> and be error-prone. Because its procedural, you may end up with a complex branching logic which finally traduce a bad code design which is difficult to maintain.</p><p>Finally, there is no reason to actually use <code>switch</code> instead of its alternative if you want to benefit what JavaScript has to offer. But must of all, the most important is you to write a code the future-you and others won’t hate!</p><div id="disqus_thread" role="complementary"></div></article></div><div class="grid__item three-tenths portable-one-whole"role="complementary"><!-- Lang navigation --><nav role="navigation"><ul class="nav nav--stacked text--center"><li class="current"><a href="/">English version</a></li><li ><a href="/fr/">Version française</a></li></ul></nav><!-- About --><aside class="text--justify"><p>My name is <span class='brand-face'>Nicolas</span> and I'm a french IT business student, doing some freelance web development aside.</p><p>I <a href='/archive'>write</a> posts about web development and project management. I got <a href='http://www.linkedin.com/profile/view?id=143126897'>LinkedIn</a>, I <a href='https://delicious.com/nicoespeon'>tag</a> and I <a href='http://twitter.com/nicoespeon'>tweet</a> too.</p></aside><!-- RSS --><aside><p class="text--center"><a href="http://nicoespeon.com/feed.xml"><i class="icon-connection"></i>&nbsp;Stay tuned</a></p></aside><!-- Tweets --><aside class="text--center visuallyhidden--portable"><a class="twitter-timeline" href="https://twitter.com/nicoespeon" data-widget-id="320422386929377280">Tweets de @nicoespeon</a></aside></div></div></div><!-- /container --></div><!-- /main-content --><footer role="contentinfo"><div class="container"><p>&copy; 2015 - <a href="https://twitter.com/nicoespeon">Nicolas (Espeon) Carlo</a><br>The website is built upon <a href='https://github.com/mojombo/jekyll'>Jekyll</a> and <a href='http://inuitcss.com/'>inuit.css</a> from the excellent <a href='https://twitter.com/csswizardry'>@csswizardry</a>. Source code is <a href='https://github.com/nicoespeon/nicoespeon.github.io'>hosted on GitHub</a>.</p></div></footer><!-- jQuery --><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script>$( function () {/*** This JS code is still small so its better to keep it inline.** Only apply if we are beyond the desk CSS breakpoint on load*/if ( $( window ).width() >= 1024 ) {var $timeline = $( "ul#timeline" );/*** Then hide every label description of the timeline*/$timeline.find( "a.timeline__label" ).each( function () {$( this ).find( "p" ).hide();} );/*** And delegate the visibility effect on hover for each label description*/$timeline.on( "mouseenter mouseleave", "a.timeline__label", function () {$( this ).find( "p" ).stop().toggle( "slow" );} );}} );</script><!-- Twitter API --><script>!function ( d, s, id ) {var js, fjs = d.getElementsByTagName( s )[0];if ( !d.getElementById( id ) ) {js = d.createElement( s );js.id = id;js.src = "//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore( js, fjs );}}( document, "script", "twitter-wjs" );</script><!-- Google Analytics --><script>var _gaq = _gaq || [];_gaq.push( ['_setAccount', 'UA-39957541-2'] );_gaq.push( ['_setDomainName', 'nicoespeon.com'] );_gaq.push( ['_trackPageview'] );(function () {var ga = document.createElement( 'script' );ga.type = 'text/javascript';ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName( 'script' )[0];s.parentNode.insertBefore( ga, s );})();</script><!-- Disqus --><script>var disqus_shortname = 'nicoespeon';var disqus_url = 'http://nicoespeon.com/en/2015/01/oop-revisited-switch-in-js';var title = "OOP - switch revisited in JavaScript";(function () {var dsq = document.createElement( 'script' );dsq.type = 'text/javascript';dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName( 'head' )[0] || document.getElementsByTagName( 'body' )[0]).appendChild( dsq );})();</script><noscript>Please enable JavaScript to view the <ahref="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></body></html>