<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1.0"><meta name="description" content="What is a pure function and why should you consider it in JavaScript?"><meta property="og:site_name" content="@nicoespeon's blog" /><meta property="og:url" content="http://www.nicoespeon.com/en/2015/01/pure-functions-javascript/" /><meta property="og:type" content="article" /><meta property="og:title" content="Pure functions in JavaScript | @nicoespeon" /><meta property="og:description" content="What is a pure function and why should you consider it in JavaScript?" /><meta property="og:image" content="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" /><title>Pure functions in JavaScript | @nicoespeon</title><link rel="icon" href="/assets/img/icon.png"><link rel="author" href="https://plus.google.com/u/0/108378377887967941980"><!-- DNS prefetch for external resources --><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//platform.twitter.com"><link rel="dns-prefetch" href="//p.twitter.com"><link rel="dns-prefetch" href="//cdn.api.twitter.com"><link rel="dns-prefetch" href="//google-analytics.com"><link rel="stylesheet"href='http://fonts.googleapis.com/css?family=Snippet|Roboto:300,100,700'><link rel="stylesheet" href="/assets/css/nicoespeon.css" media="screen"><link rel="stylesheet" href="/assets/css/nicoespeon-print.css" media="print"></head><body><div id="site"><div class="container"><div class="grid"><div class="grid__item seven-tenths portable-one-whole" role="main"><header class="media" role="banner"><!-- Brand logo --><img src="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" class="media__img img--circle" alt="My avatar" width="80" height="80"/><!-- Main navigation --><nav class="media__body" role="navigation"><ul class="nav nav--main"><li><a href="/index.html">Home</a></li><li><a href="/about.html">About</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/worth-reading.html">Worth Reading</a></li></ul></nav><!-- /navigation --></header><!-- /header --><article role="main"><h1>Pure functions in JavaScript</h1><div class="media"><a href="https://twitter.com/share" class="twitter-share-button media__img--rev" data-text="Pure functions in JavaScript |" data-via="nicoespeon">Tweeter</a><div class="media__body brand-face zeta">(25 January, 2015)</div></div><p class="islet">What is a pure function and why should you consider it in JavaScript?</p><h2 id="toc_0">What&#39;s that a &quot;pure&quot; function?</h2><p>A pure function <strong>doesn&#39;t depend on</strong> and <strong>doesn&#39;t modify the states of variables out of its scope</strong>.</p><p>Concretely, that means <strong>a pure function always returns the same result given same parameters</strong>. Its execution doesn&#39;t depend on the state of the system.</p><p>Pure functions are a pillar of <a href="http://en.wikipedia.org/wiki/Functional_programming">functional programming</a>.</p><h3 id="toc_1">Give me examples</h3><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">values</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">a</span><span class="o">:</span> <span class="mi">1</span> <span class="p">};</span>

<span class="kd">function</span> <span class="nx">impureFunction</span> <span class="p">(</span> <span class="nx">items</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="nx">items</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">items</span><span class="p">.</span><span class="nx">a</span> <span class="o">*</span> <span class="nx">b</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">impureFunction</span><span class="p">(</span> <span class="nx">values</span> <span class="p">);</span>
</code></pre></div><p>Here we modify the attributes of the given object. Hence we modify the object which lies outside of the scope of our function: the function is impure.</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">values</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">a</span><span class="o">:</span> <span class="mi">1</span> <span class="p">};</span>

<span class="kd">function</span> <span class="nx">pureFunction</span> <span class="p">(</span> <span class="nx">a</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">*</span> <span class="nx">b</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">values</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">pureFunction</span><span class="p">(</span> <span class="nx">values</span><span class="p">.</span><span class="nx">a</span> <span class="p">);</span>
</code></pre></div><p>Now we simply modify the parameter which is in the scope of the function, nothing is modified outside!</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">values</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">a</span><span class="o">:</span> <span class="mi">1</span> <span class="p">};</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">impureFunction</span> <span class="p">(</span> <span class="nx">a</span> <span class="p">)</span> <span class="p">{</span>
  <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">*</span> <span class="nx">b</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">values</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">impureFunction</span><span class="p">(</span> <span class="nx">values</span><span class="p">.</span><span class="nx">a</span> <span class="p">);</span>
</code></pre></div><p>Here, <code>b</code> is not in the scope of the function. The result will depend on the context: surprises expected!</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">values</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">a</span><span class="o">:</span> <span class="mi">1</span> <span class="p">};</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">pureFunction</span> <span class="p">(</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">c</span> <span class="p">)</span> <span class="p">{</span>
  <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">*</span> <span class="nx">c</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">values</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">pureFunction</span><span class="p">(</span> <span class="nx">values</span><span class="p">.</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span> <span class="p">);</span>
</code></pre></div><h2 id="toc_2">What does it look like, concretely?</h2><p>Considering this code exists:</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">getMinQuantity</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getMinQuantity</span> <span class="p">(</span> <span class="nx">name</span> <span class="p">)</span> <span class="p">{</span>
  <span class="c1">// A pure fonction which returns a number, regarding</span>
  <span class="c1">// the given name.</span>
<span class="p">};</span>
</code></pre></div><p>Let&#39;s take the following code example that may exist in a lambda project:</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">popover</span> <span class="o">=</span> <span class="p">{</span>

  <span class="c1">// A bunch of code…</span>

  <span class="nx">addQuantityText</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">quantity</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">quantityTextOptions</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">namespace</span><span class="o">:</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span>
      <span class="nx">initialChildIndex</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="nx">quantity</span><span class="o">:</span> <span class="nx">quantity</span>
    <span class="p">};</span>

    <span class="k">try</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">formatQuantityText</span><span class="p">(</span> <span class="nx">quantityTextOptions</span> <span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">err</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Couldn&#39;t add quantity text!&quot;</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">formatQuantityText</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">$$boxContainer</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span> <span class="s2">&quot;$$boxContainer is not configured&quot;</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">namespace</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">namespace</span> <span class="o">||</span> <span class="s2">&quot;quantity&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">quantity</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">initialChildIndex</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">initialChildIndex</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">$$quantity</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Canvas</span><span class="p">();</span> <span class="c1">// implementation details hidden</span>
    <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">namespace</span><span class="p">;</span>
    <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">quantity</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setQuantityTextColor</span><span class="p">(</span> <span class="nx">$$quantity</span> <span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">$$boxContainer</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span> <span class="nx">$$quantity</span><span class="p">,</span> <span class="nx">initialChildIndex</span> <span class="p">);</span>

    <span class="k">return</span> <span class="nx">$$quantity</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">setQuantityTextColor</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">$$quantity</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">$$quantity</span> <span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">minQuantity</span> <span class="o">=</span> <span class="nx">getMinQuantity</span><span class="p">(</span> <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">name</span> <span class="p">);</span>
    <span class="kd">var</span> <span class="nx">quantity</span> <span class="o">=</span> <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="nx">minQuantity</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">hasEnoughQuantity</span> <span class="o">=</span> <span class="p">(</span><span class="nx">quantity</span> <span class="o">&gt;=</span> <span class="nx">minQuantity</span><span class="p">);</span>

    <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="p">(</span><span class="nx">hasEnoughQuantity</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;green&quot;</span> <span class="o">:</span> <span class="s2">&quot;red&quot;</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="c1">// A bunch of code…</span>

<span class="p">};</span>
</code></pre></div><p>We&#39;ve got <code>addQuantityText()</code> which is pure, while <code>formatQuantityText()</code> and <code>setQuantityTextColor()</code> are not.</p><p>In our context, <code>addQuantityText()</code> is the method actually used when you want to &quot;display the quantity&quot; in our <code>$$boxContainer</code>. This is the entry point, dealing with implementation details. You&#39;ll look at this method when something goes wrong with <code>$$quantity</code>. Which is likely to be the start of a treasure hunt — but not a funny one.</p><p>The way it was written could be error-prone on the long term.</p><h3 id="toc_3">When it gets complicated</h3><p>In this example, the execution order of functions is critical.</p><p><strong>Just swap 2 lines and you&#39;ll break everything</strong>. It may sound obvious, but it&#39;s much more difficult to debug:</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">popover</span> <span class="o">=</span> <span class="p">{</span>

  <span class="c1">// A bunch of code…</span>

  <span class="nx">addQuantityText</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">quantity</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">quantityTextOptions</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">namespace</span><span class="o">:</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span>
      <span class="nx">initialChildIndex</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="nx">quantity</span><span class="o">:</span> <span class="nx">quantity</span>
    <span class="p">};</span>

    <span class="k">try</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">formatQuantityText</span><span class="p">(</span> <span class="nx">quantityTextOptions</span> <span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">err</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Couldn&#39;t add quantity text!&quot;</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">formatQuantityText</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">$$boxContainer</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span> <span class="s2">&quot;$$boxContainer is not configured&quot;</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">namespace</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">namespace</span> <span class="o">||</span> <span class="s2">&quot;quantity&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">quantity</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">initialChildIndex</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">initialChildIndex</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">$$quantity</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Canvas</span><span class="p">();</span> <span class="c1">// implementation details hidden</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setQuantityTextColor</span><span class="p">(</span> <span class="nx">$$quantity</span> <span class="p">);</span>
    <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">namespace</span><span class="p">;</span>
    <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">quantity</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">$$quantity</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">setQuantityTextColor</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">$$quantity</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">$$quantity</span> <span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">minQuantity</span> <span class="o">=</span> <span class="nx">getMinQuantity</span><span class="p">(</span> <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">name</span> <span class="p">);</span>
    <span class="kd">var</span> <span class="nx">quantity</span> <span class="o">=</span> <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="nx">minQuantity</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">hasEnoughQuantity</span> <span class="o">=</span> <span class="p">(</span><span class="nx">quantity</span> <span class="o">&gt;=</span> <span class="nx">minQuantity</span><span class="p">);</span>

    <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="p">(</span><span class="nx">hasEnoughQuantity</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;green&quot;</span> <span class="o">:</span> <span class="s2">&quot;red&quot;</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="c1">// A bunch of code…</span>

<span class="p">};</span>
</code></pre></div><p>Now there is an error in the code. Problem is: that&#39;s hard stuff to detect!</p><p>Here, <code>setQuantityTextColor()</code> is responsible of the color of <code>$$quantity</code>. And so you need to navigate through methods to catch the one which is the last which modifies the object, then reconstitute the whole flow to understand what&#39;s going wrong.</p><p>At this point you could even regret having decomposed <code>formatQuantityText()</code> into smaller methods to simplify implementation details.</p><p>Generally speaking, that&#39;s a lot of code that needs to be considered when you are debugging. And if you get thinking that splitting a big method into smaller ones just make the debug difficult, then the concept of <strong>pure function</strong> is gaining interest.</p><h3 id="toc_4">Let&#39;s do that with pure functions</h3><p>We&#39;ll use a maximum of pure functions to rewrite our code:</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">popover</span> <span class="o">=</span> <span class="p">{</span>

  <span class="c1">// A bunch of code…</span>

  <span class="c1">// All the modifications of system state are grouped here.</span>
  <span class="c1">// This only method is responsible for the insertion of</span>
  <span class="c1">// an element, which makes debug simpler and limit</span>
  <span class="c1">// side effects.</span>
  <span class="nx">addQuantityText</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">quantity</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">$$boxContainer</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span> <span class="s2">&quot;$$boxContainer is not configured&quot;</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">quantityTextOptions</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">namespace</span><span class="o">:</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span>
      <span class="nx">quantity</span><span class="o">:</span> <span class="nx">quantity</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">$$quantity</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">formatQuantityText</span><span class="p">(</span> <span class="nx">quantityTextOptions</span> <span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">$$boxContainer</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span> <span class="nx">$$quantity</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span>
  <span class="p">},</span>

  <span class="c1">// This method doesn&#39;t have side effects.</span>
  <span class="c1">// It just call other pure functions. It creates and return the</span>
  <span class="c1">// canvas object desired, correctly configured!</span>
  <span class="nx">formatQuantityText</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">namespace</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">namespace</span> <span class="o">||</span> <span class="s2">&quot;quantity&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">quantity</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">$$quantity</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Canvas</span><span class="p">();</span> <span class="c1">// implementation details hidden</span>
    <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">namespace</span><span class="p">;</span>
    <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">quantity</span><span class="p">;</span>
    <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getQuantityTextColor</span><span class="p">(</span> <span class="nx">quantity</span><span class="p">,</span> <span class="nx">namespace</span> <span class="p">);</span>

    <span class="k">return</span> <span class="nx">$$quantity</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="c1">// This method doesn&#39;t have side effects neither.</span>
  <span class="c1">// It returns the correct color, regarding the given quantity.</span>
  <span class="nx">getQuantityTextColor</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">quantity</span><span class="p">,</span> <span class="nx">namespace</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">minQuantity</span> <span class="o">=</span> <span class="nx">getMinQuantity</span><span class="p">(</span> <span class="nx">namespace</span> <span class="p">);</span>
    <span class="kd">var</span> <span class="nx">hasEnoughQuantity</span> <span class="o">=</span> <span class="p">(</span><span class="nx">quantity</span> <span class="o">&amp;&amp;</span> <span class="nx">quantity</span> <span class="o">&gt;=</span> <span class="nx">minQuantity</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">(</span><span class="nx">hasEnoughQuantity</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;green&quot;</span> <span class="o">:</span> <span class="s2">&quot;red&quot;</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="c1">// A bunch of code…</span>

<span class="p">};</span>
</code></pre></div><p>There is no fundamental change in this new version. However, there are non-negligible benefits.</p><p>What we did here:</p><ul><li><code>getQuantityTextColor()</code> instead of <code>setQuantityTextColor()</code></li><li>the method returns a color regarding the quantity we give to it instead of modifying the object directly, as we did before</li><li>methods don&#39;t consider variables out of their scope</li><li>methods only call pure methods</li><li>we isolated the creation / modification of the <code>$$quantity</code> object in <code>formatQuantityText()</code></li><li>we isolated modifications of the system state in <code>addQuantityText()</code></li></ul><p>Doing so, we removed methods with side effects. We just <strong>simplified the code maintenance</strong>. If there is an issue with <code>$$quantity</code> to occur, there is only one method to look for.</p><h3 id="toc_5">Simplify the interface</h3><p>We used here public methods. It&#39;d be perfectly acceptable — completely relevant — to make them private.</p><p>Indeed, there don&#39;t have much to do with our API since <strong>their role is to simplify the interface</strong>. Have a look to my post on <a href="/en/2014/12/private-methods-backbonejs/">private methods with Backbone.js</a> if you get scratching your head with that.</p><p>As they are pures, to extract them is dead easy since they don&#39;t rely on a specific context, just parameters!</p><div class="highlight"><pre><code class="javascript"><span class="kd">function</span> <span class="nx">getQuantityTextColor</span> <span class="p">(</span> <span class="nx">quantity</span><span class="p">,</span> <span class="nx">namespace</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">minQuantity</span> <span class="o">=</span> <span class="nx">getMinQuantity</span><span class="p">(</span> <span class="nx">namespace</span> <span class="p">);</span>
  <span class="kd">var</span> <span class="nx">hasEnoughQuantity</span> <span class="o">=</span> <span class="p">(</span><span class="nx">quantity</span> <span class="o">&amp;&amp;</span> <span class="nx">quantity</span> <span class="o">&gt;=</span> <span class="nx">minQuantity</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span><span class="nx">hasEnoughQuantity</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;green&quot;</span> <span class="o">:</span> <span class="s2">&quot;red&quot;</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">formatQuantityText</span> <span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">namespace</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">namespace</span> <span class="o">||</span> <span class="s2">&quot;quantity&quot;</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">quantity</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">$$quantity</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Canvas</span><span class="p">();</span> <span class="c1">// implementation details hidden</span>
  <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">namespace</span><span class="p">;</span>
  <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">quantity</span><span class="p">;</span>
  <span class="nx">$$quantity</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">getQuantityTextColor</span><span class="p">(</span> <span class="nx">quantity</span><span class="p">,</span> <span class="nx">namespace</span> <span class="p">);</span>

  <span class="k">return</span> <span class="nx">$$quantity</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div><p>And then, later in the code:</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">popover</span> <span class="o">=</span> <span class="p">{</span>

  <span class="c1">// A bunch of code…</span>

  <span class="nx">addQuantityText</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">quantity</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">$$boxContainer</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span> <span class="s2">&quot;$$boxContainer is not configured&quot;</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">quantityTextOptions</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">namespace</span><span class="o">:</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span>
      <span class="nx">quantity</span><span class="o">:</span> <span class="nx">quantity</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">$$quantity</span> <span class="o">=</span> <span class="nx">formatQuantityText</span><span class="p">(</span> <span class="nx">quantityTextOptions</span> <span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">$$boxContainer</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span> <span class="nx">$$quantity</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span>
  <span class="p">},</span>

  <span class="c1">// A bunch of code…</span>

<span class="p">};</span>
</code></pre></div><h2 id="toc_6">Advantages of pure functions</h2><p>The main advantage of a pure function is that <strong>it doesn&#39;t have any side effect</strong>. It doesn&#39;t modify the state of the system outside of their scope. Then, they just simplify and clarify the code: when you call a pure function, you just need to focus on the return value as you know you didn&#39;t broke anything elsewhere doing so.</p><p>A pure function is also robust. <strong>Its order of execution doesn&#39;t have any impact on the system</strong>. Operations with pure functions could be parallelized.</p><p>Also, <strong>it&#39;s very easy to unit test a pure function</strong> since there is no context to consider. Just focus on inputs / outputs.</p><p>Finally, maximizing the use of pure functions <strong>makes your code simpler, more flexible</strong>.</p><h2 id="toc_7">A matter of design</h2><p>In practice, when you are doing object-oriented code you may think that functional programming concepts couldn&#39;t fit in. This is simply wrong as <a href="http://blog.cleancoder.com/uncle-bob/2014/11/24/FPvsOO.html">OOP and FP are absolutely compatibles</a>!</p><p>Indeed, the idea here is simple: <strong>simplify your code by limiting the number of functions that has an impact on the system</strong>.</p><p>If you force yourself to think twice to maximize the number of pure functions in your code, you&#39;ll probably make your maintaeance / life / debug easier!</p><p>Well, you&#39;ve got the idea. Which is often, in practice, a matter of design, the choice between a <code>get</code> and a <code>set</code> for instance.</p><div id="disqus_thread" role="complementary"></div></article></div><div class="grid__item three-tenths portable-one-whole"role="complementary"><!-- Lang navigation --><nav role="navigation"><ul class="nav nav--stacked text--center"><li class="current" ><a href="/">English version</a></li><li ><a href="/fr/">Version française</a></li></ul></nav><!-- About --><aside class="text--justify"><p>My name is <span class='brand-face'>Nicolas</span> and I'm a french Unit Production Manager at <a href='http://www.metidia.com'>Metidia</a>.</p><p>I <a href='/archive'>write</a> posts about web development and project management. I got <a href='http://www.linkedin.com/profile/view?id=143126897'>LinkedIn</a>, I <a href='https://github.com/nicoespeon/'>code</a> and I <a href='http://twitter.com/nicoespeon'>tweet</a> too.</p></aside><!-- RSS --><aside><p class="text--center"><a href="http://www.nicoespeon.com/feed.xml"><i class="icon-connection"></i>&nbsp;Stay tuned</a></p></aside><!-- Tweets --><aside class="text--center visuallyhidden--portable"><a class="twitter-timeline" href="https://twitter.com/nicoespeon" data-widget-id="320422386929377280">Tweets de @nicoespeon</a></aside><aside class="visuallyhidden--portable push--top"><h2 class="text--center">Friends</h2><a href="http://iceranking.com">IceRanking.com</a> - (SEO) Cédric Brun, Consultant en Référencement Durable</aside></div></div></div><!-- /container --></div><!-- /main-content --><footer role="contentinfo"><div class="container"><p>&copy; 2015 - <a href="https://twitter.com/nicoespeon">Nicolas (Espeon) Carlo</a><br>The website is built upon <a href='https://github.com/mojombo/jekyll'>Jekyll</a> and <a href='http://inuitcss.com/'>inuit.css</a> from the excellent <a href='https://twitter.com/csswizardry'>@csswizardry</a>. Source code is <a href='https://github.com/nicoespeon/nicoespeon.github.io'>hosted on GitHub</a>.</p></div></footer><!-- jQuery --><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script>$( function () {/*** This JS code is still small so its better to keep it inline.** Only apply if we are beyond the desk CSS breakpoint on load*/if ( $( window ).width() >= 1024 ) {var $timeline = $( "ul#timeline" );/*** Then hide every label description of the timeline*/$timeline.find( "a.timeline__label" ).each( function () {$( this ).find( "p" ).hide();} );/*** And delegate the visibility effect on hover for each label description*/$timeline.on( "mouseenter mouseleave", "a.timeline__label", function () {$( this ).find( "p" ).stop().toggle( "slow" );} );}} );</script><!-- Twitter API --><script>!function ( d, s, id ) {var js, fjs = d.getElementsByTagName( s )[0];if ( !d.getElementById( id ) ) {js = d.createElement( s );js.id = id;js.src = "//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore( js, fjs );}}( document, "script", "twitter-wjs" );</script><!-- Google Analytics --><script>var _gaq = _gaq || [];_gaq.push( ['_setAccount', 'UA-39957541-2'] );_gaq.push( ['_setDomainName', 'nicoespeon.com'] );_gaq.push( ['_trackPageview'] );(function () {var ga = document.createElement( 'script' );ga.type = 'text/javascript';ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName( 'script' )[0];s.parentNode.insertBefore( ga, s );})();</script><!-- Disqus --><script>var disqus_shortname = 'nicoespeon';var disqus_url = 'http://nicoespeon.com/en/2015/01/pure-functions-javascript/';var title = "Pure functions in JavaScript";(function () {var dsq = document.createElement( 'script' );dsq.type = 'text/javascript';dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName( 'head' )[0] || document.getElementsByTagName( 'body' )[0]).appendChild( dsq );})();</script><noscript>Please enable JavaScript to view the <ahref="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></body></html>